{"version":3,"names":["stylesCss","ZPopoverStyle0","DOCUMENT_ELEMENT","document","documentElement","getParentElement","element","parentNode","host","findScrollableParent","parent","overflow","overflowX","overflowY","window","getComputedStyle","scrollHeight","clientHeight","scrollWidth","clientWidth","computeOffset","targetParentOffset","rect","getBoundingClientRect","width","height","top","left","offsetParent","offsetLeft","body","scrollY","offsetTop","DOMMatrix","style","transform","webkitTransform","domMatrix","m41","m42","parentWidth","parentHeight","innerWidth","innerHeight","offsetWidth","offsetHeight","right","bottom","ZPopover","PopoverPosition","AUTO","closePopoverWithKeyboard","e","this","closable","key","KeyboardCode","ESC","open","handleOutsideClick","composedPath","includes","target","triggerElemClicked","bindTo","HTMLElement","contains","closest","CSS","escape","stopPropagation","positionChange","emit","position","currentPosition","validatePosition","newValue","Object","values","onOpen","cancelAnimationFrame","animationFrameRequestId","setPosition","requestAnimationFrame","hasAttribute","removeAttribute","undefined","openChange","disconnectedCallback","ownerDocument","querySelector","parentElement","scrollContainer","scrollingBoundingRect","offsetContainer","relativeBoundingRect","boundingRect","scrollTop","scrollLeft","overflowBottom","Math","max","overflowRight","availableTop","min","availableBottom","availableLeft","availableRight","availableHeight","availableWidth","positions","push","LEFT","RIGHT","unshift","TOP","BOTTOM","join","offsetRight","offsetBottom","offsetModifier","center","sizeModifier","TOP_RIGHT","maxHeight","maxWidth","TOP_LEFT","BOTTOM_RIGHT","BOTTOM_LEFT","RIGHT_BOTTOM","RIGHT_TOP","LEFT_BOTTOM","LEFT_TOP","setAttribute","componentWillLoad","render","h"],"sources":["src/components/z-popover/styles.css?tag=z-popover&encapsulation=shadow","src/components/z-popover/index.tsx"],"sourcesContent":[":host {\n  --z-popover-theme--surface: var(--color-surface01);\n  --z-popover-theme--text: var(--color-text01);\n  --z-popover-padding: 0;\n  --z-popover-shadow-filter: drop-shadow(0 1px 2px var(--shadow-color-base));\n\n  position: relative;\n  display: none;\n  min-width: calc(var(--space-unit) * 8);\n  min-height: calc(var(--space-unit) * 4);\n  align-items: center;\n  justify-content: center;\n  padding: var(--z-popover-padding);\n  background: var(--z-popover-theme--surface);\n  border-radius: var(--border-radius-small);\n  color: var(--z-popover-theme--text);\n  fill: currentcolor;\n  filter: var(--z-popover-shadow-filter);\n  font-family: var(--font-family-sans);\n  text-align: center;\n}\n\n:host([open][current-position]),\n:host([open=\"true\"][current-position]) {\n  display: flex;\n}\n\n:host([center][current-position=\"top\"]),\n:host([center][current-position=\"bottom\"]) {\n  transform: translateX(-50%);\n}\n\n:host([center][current-position=\"right\"]),\n:host([center][current-position=\"left\"]) {\n  transform: translateY(-50%);\n}\n\n:host([current-position^=\"top\"]) {\n  margin: 0 0 var(--space-unit);\n}\n\n:host([current-position^=\"bottom\"]) {\n  margin: var(--space-unit) 0 0;\n}\n\n:host([current-position^=\"left\"]) {\n  margin: 0 var(--space-unit) 0 0;\n}\n\n:host([current-position^=\"right\"]) {\n  margin: 0 0 0 var(--space-unit);\n}\n\n/* Arrow style */\n\n:host([current-position])::before {\n  --arrow-size: 6px;\n  --arrow-edge-offset: calc(100% - var(--space-unit) - (var(--arrow-size) / 2));\n  --arrow-center-x-offset: calc(50% - (var(--arrow-size) / 2));\n  --arrow-center-y-offset: calc(100% - (var(--arrow-size) / 2));\n\n  position: absolute;\n  display: block;\n  width: var(--arrow-size);\n  height: var(--arrow-size);\n  background: var(--z-popover-theme--surface);\n  content: \"\";\n  transform: rotate(45deg);\n}\n\n:host([show-arrow=\"false\"])::before,\n:host(:not([show-arrow]))::before {\n  display: none;\n}\n\n:host([current-position^=\"top\"])::before {\n  top: var(--arrow-center-y-offset);\n}\n\n:host([current-position^=\"bottom\"])::before {\n  bottom: var(--arrow-center-y-offset);\n}\n\n:host([current-position=\"top\"])::before,\n:host([current-position=\"bottom\"])::before {\n  right: var(--arrow-edge-offset);\n}\n\n:host([current-position=\"right\"])::before,\n:host([current-position=\"left\"])::before {\n  bottom: var(--arrow-edge-offset);\n}\n\n:host([current-position=\"right\"])::before {\n  right: var(--arrow-center-y-offset);\n}\n\n:host([current-position=\"left\"])::before {\n  left: var(--arrow-center-y-offset);\n}\n\n:host([current-position=\"top_right\"])::before,\n:host([current-position=\"bottom_right\"])::before {\n  right: var(--arrow-edge-offset);\n}\n\n:host([current-position=\"top_left\"])::before,\n:host([current-position=\"bottom_left\"])::before {\n  left: var(--arrow-edge-offset);\n}\n\n:host([current-position=\"right_top\"])::before,\n:host([current-position=\"left_top\"])::before {\n  top: var(--arrow-edge-offset);\n}\n\n:host([current-position=\"right_top\"])::before,\n:host([current-position=\"right_bottom\"])::before {\n  right: var(--arrow-center-y-offset);\n}\n\n:host([current-position=\"left_top\"])::before,\n:host([current-position=\"left_bottom\"])::before {\n  left: var(--arrow-center-y-offset);\n}\n\n:host([current-position=\"right_bottom\"])::before,\n:host([current-position=\"left_bottom\"])::before {\n  bottom: var(--arrow-edge-offset);\n}\n\n:host([center][current-position=\"top\"])::before,\n:host([center][current-position=\"bottom\"])::before {\n  right: auto;\n  left: var(--arrow-center-x-offset);\n}\n\n:host([center][current-position=\"right\"])::before,\n:host([center][current-position=\"left\"])::before {\n  top: var(--arrow-center-x-offset);\n  bottom: auto;\n}\n\n::slotted(*) {\n  overflow: auto;\n  flex: 1 auto;\n}\n","import {Component, Prop, h, Watch, Listen, Element, State, Event, EventEmitter} from \"@stencil/core\";\nimport {PopoverPosition, KeyboardCode} from \"../../beans\";\n\nconst DOCUMENT_ELEMENT = document.documentElement;\n\nfunction getParentElement(element: Element): ShadowRoot[\"host\"] {\n  if ((element.parentNode as ShadowRoot).host) {\n    return (element.parentNode as ShadowRoot).host;\n  }\n\n  return element.parentNode as Element;\n}\n\n/**\n * Find the closest scrollable parent of a node.\n *\n * @param {Element} element The node\n */\nfunction findScrollableParent(element: Element): Element {\n  let parent = getParentElement(element);\n\n  while (parent && parent !== DOCUMENT_ELEMENT) {\n    const {overflow, overflowX, overflowY} = window.getComputedStyle(parent);\n    if (overflow === \"hidden\" || overflowY === \"hidden\" || overflowX === \"hidden\") {\n      return parent;\n    }\n\n    if (\n      (parent.scrollHeight > parent.clientHeight && overflow !== \"visible\" && overflowY !== \"visible\") ||\n      (parent.scrollWidth > parent.clientWidth && overflow !== \"visible\" && overflowX !== \"visible\")\n    ) {\n      return parent;\n    }\n\n    parent = getParentElement(parent);\n  }\n\n  return DOCUMENT_ELEMENT;\n}\n\n/**\n * Calculate computed offset.\n * It includes matrix transformations.\n * @param element The target element.\n * @param targetParentOffset The relative offset parent.\n * @return A client rect object.\n */\nfunction computeOffset(element: HTMLElement, targetParentOffset?: HTMLElement): Record<string, number> {\n  const rect = element.getBoundingClientRect();\n  const width = rect.width;\n  const height = rect.height;\n\n  let top = 0;\n  let left = 0;\n  let offsetParent = element;\n  while (offsetParent && offsetParent != targetParentOffset) {\n    left += offsetParent.offsetLeft;\n\n    // document.body sometimes has offsetTop == 0 but still has an\n    // offset because of children margins!\n    if (offsetParent === document.body) {\n      top += offsetParent.getBoundingClientRect().top + window.scrollY;\n    } else {\n      top += offsetParent.offsetTop;\n    }\n\n    if (window.DOMMatrix) {\n      const style = window.getComputedStyle(offsetParent);\n      const transform = style.transform || style.webkitTransform;\n      const domMatrix = new DOMMatrix(transform);\n      if (domMatrix) {\n        left += domMatrix.m41;\n        if (offsetParent !== document.body) {\n          top += domMatrix.m42;\n        }\n      }\n    }\n\n    if (!offsetParent.offsetParent) {\n      break;\n    }\n\n    offsetParent = offsetParent.offsetParent as HTMLElement;\n  }\n\n  let parentWidth: number;\n  let parentHeight: number;\n  if (offsetParent === document.body) {\n    parentWidth = window.innerWidth;\n    parentHeight = window.innerHeight;\n  } else {\n    parentWidth = offsetParent.offsetWidth;\n    parentHeight = offsetParent.offsetHeight;\n  }\n\n  const right = parentWidth - left - rect.width;\n  const bottom = parentHeight - top - rect.height;\n\n  return {top, right, bottom, left, width, height};\n}\n\n/**\n * Popover component.\n *\n * @cssprop --z-popover-theme--surface - background color of the popover.\n * @cssprop --z-popover-theme--text - foreground color of the popover.\n * @cssprop --z-popover-padding - padding of the popover.\n * @cssprop --z-popover-shadow-filter - drop-shadow filter of the popover. Defaults to `drop-shadow(0 1px 2px var(--shadow-color-base))`.\n */\n@Component({\n  tag: \"z-popover\",\n  styleUrl: \"styles.css\",\n  shadow: true,\n})\nexport class ZPopover {\n  /** Popover position. */\n  @Prop({reflect: true})\n  position: PopoverPosition = PopoverPosition.AUTO;\n\n  /**\n   * The open state of the popover.\n   */\n  @Prop({reflect: true, mutable: true})\n  open = false;\n\n  /**\n   * The selector or the element bound with the popover.\n   */\n  @Prop()\n  bindTo?: string | HTMLElement;\n\n  /**\n   * Whether to show popover's arrow.\n   */\n  @Prop({reflect: true})\n  showArrow = false;\n\n  /**\n   * Whether to center the popup on the main side (according to \"position\").\n   */\n  @Prop({reflect: true})\n  center = false;\n\n  /**\n   * If true, the popover can be closed by clicking outside of it or pressing the escape key.\n   * Otherwise, it will be closed only programmatically (by setting `open` to `false`).\n   */\n  @Prop()\n  closable = true;\n\n  /**\n   * The current position of the popover.\n   */\n  @State()\n  currentPosition?: PopoverPosition;\n\n  /**\n   * Position change event.\n   */\n  @Event()\n  positionChange: EventEmitter;\n\n  /**\n   * Open change event.\n   */\n  @Event()\n  openChange: EventEmitter;\n\n  @Element() host: HTMLZPopoverElement;\n\n  private animationFrameRequestId?: number;\n\n  @Listen(\"keyup\", {target: \"window\"})\n  closePopoverWithKeyboard(e: KeyboardEvent): void {\n    if (this.closable && e.key === KeyboardCode.ESC) {\n      this.open = false;\n    }\n  }\n\n  /**\n   * Close the popover when clicking outside of its content.\n   * Stop event propagation if the click was fired by popover's trigger element,\n   * to prevent close and reopen glitches.\n   * @param {MouseEvent} e\n   */\n  @Listen(\"click\", {target: \"body\", capture: true})\n  handleOutsideClick(e: MouseEvent): void {\n    if (!this.closable || !this.open) {\n      return;\n    }\n\n    if (!e.composedPath().includes(this.host)) {\n      const target = e.target as HTMLElement;\n      const triggerElemClicked =\n        this.bindTo instanceof HTMLElement ? this.bindTo.contains(target) : target.closest(CSS.escape(this.bindTo));\n      if (triggerElemClicked) {\n        e.stopPropagation();\n      }\n\n      this.open = false;\n      this.positionChange.emit({position: this.currentPosition});\n    }\n  }\n\n  @Watch(\"position\")\n  validatePosition(newValue: PopoverPosition): void {\n    if (newValue && !Object.values(PopoverPosition).includes(newValue as PopoverPosition)) {\n      this.position = PopoverPosition.AUTO;\n    }\n\n    this.currentPosition = this.position;\n    this.positionChange.emit({position: this.currentPosition});\n  }\n\n  /**\n   * Setup popover behaviors on opening.\n   */\n  @Watch(\"open\")\n  onOpen(): void {\n    cancelAnimationFrame(this.animationFrameRequestId);\n    if (this.open) {\n      const setPosition = (): void => {\n        if (this.open) {\n          this.setPosition();\n          this.animationFrameRequestId = requestAnimationFrame(setPosition);\n        }\n      };\n\n      setPosition();\n    } else if (this.host.hasAttribute(\"current-position\")) {\n      this.host.removeAttribute(\"current-position\");\n      this.currentPosition = undefined;\n    }\n\n    this.openChange.emit({open: this.open});\n  }\n\n  disconnectedCallback(): void {\n    cancelAnimationFrame(this.animationFrameRequestId);\n  }\n\n  /**\n   * Set the position of the popover.\n   */\n  private setPosition(): void {\n    let element: HTMLElement;\n    if (typeof this.bindTo === \"string\") {\n      element = this.host.ownerDocument.querySelector(CSS.escape(this.bindTo)) as HTMLElement;\n    } else if (this.bindTo) {\n      element = this.bindTo;\n    } else {\n      element = this.host.parentElement as HTMLElement;\n    }\n\n    if (!element) {\n      return;\n    }\n\n    const scrollContainer = findScrollableParent(element) as HTMLElement;\n    const scrollingBoundingRect = scrollContainer.getBoundingClientRect();\n    const offsetContainer = this.host.offsetParent as HTMLElement;\n\n    const relativeBoundingRect = offsetContainer\n      ? computeOffset(offsetContainer, scrollContainer)\n      : {top: 0, right: 0, bottom: 0, left: 0};\n    const boundingRect = computeOffset(element, scrollContainer);\n\n    const top = boundingRect.top - scrollContainer.scrollTop;\n    const bottom = scrollingBoundingRect.height - (boundingRect.top + boundingRect.height) + scrollContainer.scrollTop;\n    const left = boundingRect.left - scrollContainer.scrollLeft;\n    const right = scrollingBoundingRect.width - (boundingRect.left + boundingRect.width) + scrollContainer.scrollLeft;\n\n    const overflowBottom = Math.max(0, scrollingBoundingRect.top + scrollingBoundingRect.height - window.innerHeight);\n    const overflowRight = Math.max(0, scrollingBoundingRect.left + scrollingBoundingRect.width - window.innerWidth);\n\n    const availableTop = Math.min(top, top + scrollingBoundingRect.top);\n    const availableBottom = Math.min(bottom, bottom - overflowBottom);\n    const availableLeft = Math.min(left, left + scrollingBoundingRect.left);\n    const availableRight = Math.min(right, right - overflowRight);\n\n    const availableHeight = availableTop + availableBottom + boundingRect.height;\n    const availableWidth = availableLeft + availableRight + boundingRect.width;\n\n    let position = this.currentPosition;\n    const positions: PopoverPosition[] = [];\n    if (this.position === PopoverPosition.AUTO) {\n      /**\n       * The `AUTO` position tries to place the popover in the 'safest' area,\n       * where there's more space available.\n       */\n      if (availableLeft / availableWidth > 0.6) {\n        positions.push(PopoverPosition.LEFT);\n      } else if (availableLeft / availableWidth < 0.4) {\n        positions.push(PopoverPosition.RIGHT);\n      }\n\n      if (availableTop / availableHeight > 0.9) {\n        positions.unshift(PopoverPosition.TOP);\n      } else if (availableTop / availableHeight > 0.6) {\n        positions.push(PopoverPosition.TOP);\n      } else if (availableTop / availableHeight < 0.1) {\n        positions.unshift(PopoverPosition.BOTTOM);\n      } else {\n        positions.push(PopoverPosition.BOTTOM);\n      }\n\n      position = positions.join(\"_\") as PopoverPosition;\n    }\n\n    const style = this.host.style;\n    style.position = \"absolute\";\n\n    const offsetTop = boundingRect.top - relativeBoundingRect.top;\n    const offsetRight = boundingRect.right - relativeBoundingRect.right;\n    const offsetBottom = boundingRect.bottom - relativeBoundingRect.bottom;\n    const offsetLeft = boundingRect.left - relativeBoundingRect.left;\n    const offsetModifier = this.center ? 0.5 : 0;\n    const sizeModifier = this.center ? 0.5 : 0;\n\n    if (position === PopoverPosition.TOP || position === PopoverPosition.TOP_RIGHT) {\n      style.top = \"auto\";\n      style.right = \"auto\";\n      style.bottom = `${offsetBottom + boundingRect.height}px`;\n\n      style.left = `${offsetLeft + boundingRect.width * offsetModifier}px`;\n      style.maxHeight = `${availableTop}px`;\n      if (position === PopoverPosition.TOP_RIGHT) {\n        style.maxWidth = `${availableRight + boundingRect.width * sizeModifier}px`;\n      }\n    } else if (position === PopoverPosition.TOP_LEFT) {\n      style.top = \"auto\";\n      style.right = `${offsetRight + boundingRect.width * offsetModifier}px`;\n      style.bottom = `${offsetBottom + boundingRect.height}px`;\n      style.left = \"auto\";\n      style.maxWidth = `${availableLeft}px`;\n      style.maxHeight = `${availableTop}px`;\n    } else if (position === PopoverPosition.BOTTOM || position === PopoverPosition.BOTTOM_RIGHT) {\n      style.top = `${offsetTop + boundingRect.height}px`;\n      style.right = \"auto\";\n      style.bottom = \"auto\";\n      style.left = `${offsetLeft + boundingRect.width * offsetModifier}px`;\n      style.maxHeight = `${availableBottom}px`;\n      if (position === PopoverPosition.BOTTOM_RIGHT) {\n        style.maxWidth = `${availableRight + boundingRect.width * sizeModifier}px`;\n      }\n    } else if (position === PopoverPosition.BOTTOM_LEFT) {\n      style.top = `${offsetTop + boundingRect.height}px`;\n      style.right = `${offsetRight + boundingRect.width * offsetModifier}px`;\n      style.bottom = \"auto\";\n      style.left = \"auto\";\n      style.maxWidth = `${availableLeft}px`;\n      style.maxHeight = `${availableBottom}px`;\n    } else if (position === PopoverPosition.RIGHT || position === PopoverPosition.RIGHT_BOTTOM) {\n      style.top = `${offsetTop + boundingRect.height * offsetModifier}px`;\n      style.right = \"auto\";\n      style.bottom = \"auto\";\n      style.left = `${offsetLeft + boundingRect.width}px`;\n      style.maxWidth = `${availableRight}px`;\n      style.maxHeight = `${availableBottom + boundingRect.height * sizeModifier}px`;\n    } else if (position === PopoverPosition.RIGHT_TOP) {\n      style.top = \"auto\";\n      style.right = \"auto\";\n      style.bottom = `${offsetBottom + boundingRect.height * offsetModifier}px`;\n      style.left = `${offsetLeft + boundingRect.width}px`;\n      style.maxWidth = `${availableRight}px`;\n      style.maxHeight = `${availableTop + boundingRect.height * sizeModifier}px`;\n    } else if (position === PopoverPosition.LEFT || position === PopoverPosition.LEFT_BOTTOM) {\n      style.top = `${offsetTop + boundingRect.height * offsetModifier}px`;\n      style.right = `${offsetRight + boundingRect.width}px`;\n      style.bottom = \"auto\";\n      style.left = \"auto\";\n      style.maxWidth = `${availableLeft}px`;\n      style.maxHeight = `${availableBottom + boundingRect.height * sizeModifier}px`;\n    } else if (position === PopoverPosition.LEFT_TOP) {\n      style.top = \"auto\";\n      style.right = `${offsetRight + boundingRect.width}px`;\n      style.bottom = `${offsetBottom + boundingRect.height * offsetModifier}px`;\n      style.left = \"auto\";\n      style.maxWidth = `${availableLeft}px`;\n      style.maxHeight = `${availableTop + boundingRect.height * sizeModifier}px`;\n    }\n\n    this.currentPosition = position || this.position;\n    this.host.setAttribute(\"current-position\", this.currentPosition);\n  }\n\n  componentWillLoad(): void {\n    this.validatePosition(this.position);\n    this.onOpen();\n  }\n\n  render(): HTMLSlotElement {\n    return <slot></slot>;\n  }\n}\n"],"mappings":"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"}