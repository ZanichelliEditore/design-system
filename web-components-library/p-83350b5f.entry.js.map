{"version":3,"names":["stylesCss","ZMyzCardInfoStyle0","ZMyzCardInfo","emitFlipCard","showBack","this","flipCard","emit","constructor","hostRef","bind","componentWillLoad","setStringOrArray","componentWillUpdate","componentDidRender","handleContentHeight","contentWrapper","infoWrapper","hiddenContent","scrollHeight","offsetHeight","height","onlineLicenseWrapper","offlineLicenseWrapper","style","data","cardData","JSON","parse","renderCloseIcon","h","name","width","onClick","tabindex","htmltabindex","onKeyUp","e","handleKeyboardSubmit","renderGeneralSection","title","_a","description","_b","class","tooltip","ref","el","renderAuthor","renderYear","author","year","renderTooltip","position","PopoverPosition","RIGHT","setExpirationLicenseMessage","type","onlineLicense","expired","offlineLicense","expiring","renderOnlineLicenseSection","expiration","renderOfflineLicenseSection","installations","render","key"],"sources":["src/snowflakes/myz/card/z-myz-card-info/styles.css?tag=z-myz-card-info&encapsulation=shadow","src/snowflakes/myz/card/z-myz-card-info/index.tsx"],"sourcesContent":[":host {\n  width: 100%;\n  font-family: var(--font-family-sans);\n  font-weight: var(--font-rg);\n}\n\n:host > div {\n  position: relative;\n  display: grid;\n  width: calc(100% + calc(var(--space-unit) * 2));\n  height: 402px;\n  box-sizing: border-box;\n  padding: calc(var(--space-unit) * 2) calc(var(--space-unit) * 3);\n  border: var(--border-size-small) solid var(--color-primary01);\n  margin-left: calc(-1 * var(--space-unit));\n  background: var(--color-surface01);\n  border-radius: 0;\n  box-shadow: 0 2px 4px 0 rgb(66 69 72 / 35%);\n}\n\n:host > div > z-icon {\n  position: absolute;\n  top: var(--space-unit);\n  right: var(--space-unit);\n  cursor: pointer;\n  fill: var(--color-primary01);\n}\n\n:host > div > div.cta-wrapper {\n  display: flex;\n  flex-flow: column nowrap;\n  align-self: end;\n  justify-content: space-between;\n}\n\n:host > div > div.content-wrapper {\n  position: relative;\n  overflow: hidden;\n  align-self: stretch;\n}\n\n:host > div > div.content-wrapper > section {\n  box-sizing: border-box;\n  padding: var(--space-unit) 0;\n  border-bottom: var(--border-size-small) solid var(--color-surface04);\n  color: var(--color-surface05);\n  font-size: 14px;\n  line-height: 20px;\n}\n\n:host > div > div.content-wrapper > section:last-child {\n  border-bottom: none;\n}\n\n:host > div > div.content-wrapper > section.info-wrapper {\n  position: relative;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n\n:host > div > div.content-wrapper > section.info-wrapper.hidden::after {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: linear-gradient(180deg, rgb(255 0 0 / 0%), rgb(255 0 0 / 0%) 60%, white);\n  content: \"\";\n  pointer-events: none;\n}\n\n:host > div > div.content-wrapper > section > span.license-heading {\n  display: flex;\n  justify-content: space-between;\n}\n\n:host > div > div.content-wrapper > section > span.license-heading > span.expired {\n  color: var(--color-secondary02);\n  font-size: 12px;\n  font-weight: 600;\n}\n\n:host > div > div.content-wrapper > section > span.license-heading > span.expiring {\n  color: var(--color-warning01);\n  font-size: 12px;\n  font-weight: 600;\n}\n\n:host > div > div.content-wrapper > z-popover {\n  position: absolute;\n  top: 0;\n  left: calc(var(--space-unit) * 4);\n}\n","import {Component, Event, EventEmitter, Prop, State, h} from \"@stencil/core\";\nimport {DictionaryData, PopoverPosition} from \"../../../../beans\";\nimport {handleKeyboardSubmit} from \"../../../../utils/utils\";\n\n/**\n * @slot  - content\n */\n@Component({\n  tag: \"z-myz-card-info\",\n  styleUrl: \"styles.css\",\n  shadow: true,\n})\nexport class ZMyzCardInfo {\n  /** dictionary info */\n  @Prop()\n  data: string | DictionaryData;\n\n  /** tabindex link attribute (optional) */\n  @Prop()\n  htmltabindex?: number = 0;\n\n  @State()\n  hiddenContent = false;\n\n  @State()\n  tooltip = false;\n\n  private cardData: DictionaryData;\n\n  private contentWrapper: HTMLElement;\n\n  private infoWrapper: HTMLElement;\n\n  private onlineLicenseWrapper: HTMLElement;\n\n  private offlineLicenseWrapper: HTMLElement;\n\n  /** flip card to front */\n  @Event()\n  flipCard: EventEmitter;\n\n  private emitFlipCard(showBack = false): void {\n    this.flipCard.emit(showBack);\n  }\n\n  constructor() {\n    this.emitFlipCard = this.emitFlipCard.bind(this);\n  }\n\n  componentWillLoad(): void {\n    this.setStringOrArray();\n  }\n\n  componentWillUpdate(): void {\n    this.setStringOrArray();\n  }\n\n  componentDidRender(): void {\n    this.handleContentHeight();\n  }\n\n  private handleContentHeight(): void {\n    if (!this.contentWrapper && !this.infoWrapper) {\n      this.hiddenContent = false;\n\n      return;\n    }\n\n    if (\n      this.contentWrapper.scrollHeight > this.contentWrapper.offsetHeight ||\n      this.infoWrapper.scrollHeight > this.infoWrapper.offsetHeight\n    ) {\n      const height =\n        this.contentWrapper.offsetHeight -\n        this.onlineLicenseWrapper.offsetHeight -\n        this.offlineLicenseWrapper.offsetHeight;\n      this.infoWrapper.style.height = `${height}px`;\n      this.hiddenContent = true;\n\n      return;\n    }\n\n    this.hiddenContent = false;\n  }\n\n  private setStringOrArray(): void {\n    if (typeof this.data === \"string\") {\n      this.cardData = JSON.parse(this.data);\n    } else {\n      this.cardData = this.data;\n    }\n  }\n\n  private renderCloseIcon(): HTMLZIconElement {\n    return (\n      <z-icon\n        name=\"multiply-circled-filled\"\n        height={18}\n        width={18}\n        onClick={() => this.emitFlipCard(false)}\n        tabindex={this.htmltabindex}\n        onKeyUp={(e: KeyboardEvent) => {\n          handleKeyboardSubmit(e, this.emitFlipCard, false);\n        }}\n      />\n    );\n  }\n\n  private renderGeneralSection(): HTMLElement {\n    const title = this?.cardData?.title;\n    const description = this?.cardData?.description;\n\n    return (\n      <section\n        class={`info-wrapper ${this.hiddenContent ? \"hidden\" : \"\"}`}\n        onClick={() => {\n          if (this.hiddenContent) {\n            this.tooltip = !this.tooltip;\n          }\n        }}\n        ref={(el) => (this.infoWrapper = el)}\n      >\n        {this.renderAuthor()}\n        {this.renderYear()}\n        {title}\n        <br />\n        {description}\n      </section>\n    );\n  }\n\n  private renderAuthor(): HTMLSpanElement {\n    const author = this?.cardData?.author;\n    if (!author) {\n      return null;\n    }\n\n    return (\n      <span>\n        Autore: <b>{author}</b>\n        <br />\n      </span>\n    );\n  }\n\n  private renderYear(): HTMLSpanElement {\n    const year = this?.cardData?.year;\n    if (!year) {\n      return null;\n    }\n\n    return (\n      <span>\n        Anno: <b>{year}</b>\n        <br />\n      </span>\n    );\n  }\n\n  private renderTooltip(): HTMLZPopoverElement {\n    if (!this.tooltip) {\n      return;\n    }\n\n    if (!this.cardData) {\n      return;\n    }\n    const {title, year, author, description} = this.cardData;\n\n    return (\n      <z-popover\n        position={PopoverPosition.RIGHT}\n        onClick={() => (this.tooltip = false)}\n      >\n        {`${title} ${year} ${author} ${description}`}\n      </z-popover>\n    );\n  }\n\n  private setExpirationLicenseMessage(type: string): HTMLSpanElement {\n    if (\n      (type === \"online\" && this.cardData.onlineLicense.expired) ||\n      (type === \"offline\" && this.cardData.offlineLicense.expired)\n    ) {\n      return <span class=\"expired\">SCADUTA</span>;\n    }\n\n    if (\n      (type === \"online\" && this.cardData.onlineLicense.expiring) ||\n      (type === \"offline\" && this.cardData.offlineLicense.expiring)\n    ) {\n      return <span class=\"expiring\">IN SCADENZA</span>;\n    }\n  }\n\n  private renderOnlineLicenseSection(): HTMLElement {\n    if (!this?.cardData?.onlineLicense) {\n      return;\n    }\n\n    return (\n      <section ref={(el) => (this.onlineLicenseWrapper = el)}>\n        <span class=\"license-heading\">\n          <span>Licenza online</span>\n          {this.setExpirationLicenseMessage(\"online\")}\n        </span>\n        Scadenza il <b>{this.cardData.onlineLicense.expiration}</b>\n        <br />\n      </section>\n    );\n  }\n\n  private renderOfflineLicenseSection(): HTMLElement {\n    if (!this?.cardData?.offlineLicense) {\n      return;\n    }\n\n    return (\n      <section ref={(el) => (this.offlineLicenseWrapper = el)}>\n        <span class=\"license-heading\">\n          <span>Licenza offline</span>\n          {this.setExpirationLicenseMessage(\"offline\")}\n        </span>\n        Scadenza il <b>{this.cardData.offlineLicense.expiration}</b>\n        <br />\n        Installazioni disponibili: <b>{this.cardData.offlineLicense.installations}</b>\n      </section>\n    );\n  }\n\n  render(): HTMLDivElement {\n    return (\n      <div>\n        {this.renderCloseIcon()}\n        <div\n          class=\"content-wrapper\"\n          ref={(el) => (this.contentWrapper = el)}\n        >\n          {this.renderGeneralSection()}\n          {this.renderTooltip()}\n          {this.renderOnlineLicenseSection()}\n          {this.renderOfflineLicenseSection()}\n        </div>\n        <div class=\"cta-wrapper\">\n          <slot />\n        </div>\n      </div>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}