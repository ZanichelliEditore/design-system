import{r as t,h as e,c as s,g as i}from"./p-d17ebc2f.js";import{h as l,n as r}from"./p-9ecf936d.js";import{r as c,d as a,a as o,h as n,e as h}from"./p-30fcd62b.js";import"./p-d69e14fb.js";const p=class{constructor(e){t(this,e),this.disabled=!1}render(){return e("label",{htmlFor:this.htmlfor,class:{disabled:this.disabled}},this.value)}};p.style="label{display:block;margin:var(--space-unit) 0;color:var(--color-text02);font-family:var(--font-family-sans);font-size:var(--font-size-1);font-weight:var(--font-sb);letter-spacing:0.32px;line-height:1.33;text-align:left;text-transform:uppercase}label.disabled{color:var(--color-disabled02)}";const d=class{constructor(e){t(this,e),this.optionSelect=s(this,"optionSelect",7),this.htmlid=`id-${c()}`,this.ariaLabel="",this.disabled=!1,this.readonly=!1,this.message=!0,this.autocomplete=!1,this.noresultslabel="Nessun risultato",this.isOpen=!1,this.selectedItem=null,this.itemsList=[],this.toggleSelectUl=this.toggleSelectUl.bind(this),this.selectItem=this.selectItem.bind(this),this.handleSelectFocus=this.handleSelectFocus.bind(this)}watchItems(){this.itemsList=this.getInitialItemsArray(),this.selectedItem=this.itemsList.find((t=>t.selected))}async getSelectedItem(){return this.selectedItem}async getValue(){return this.getSelectedValue()}async setValue(t){let e=[];"string"==typeof t?e.push(t):e=t,this.selectedItem=this.itemsList.find((t=>e.includes(t.id)))}emitOptionSelect(){this.optionSelect.emit({id:this.htmlid,selected:this.getSelectedValue()})}componentWillLoad(){this.watchItems()}componentWillRender(){this.filterItems(this.searchString)}getInitialItemsArray(){return"string"==typeof this.items?JSON.parse(this.items):this.items}mapSelectedItemToItemsArray(){return this.getInitialItemsArray().map((t=>{var e;return t.selected=t.id===(null===(e=this.selectedItem)||void 0===e?void 0:e.id),t}))}getSelectedValue(){var t;return null===(t=this.selectedItem)||void 0===t?void 0:t.id}filterItems(t){const e=this.mapSelectedItemToItemsArray();this.itemsList=(null==t?void 0:t.length)?e.filter((e=>e.name.toUpperCase().includes(t.toUpperCase()))).map((e=>{const s=e.name.toUpperCase().indexOf(t.toUpperCase()),i=s+t.length,l=e.name.substring(0,s)+`<strong>${e.name.substring(s,i)}</strong>`+e.name.substring(i,e.name.length);return e.name=l,e})):e}hasAutocomplete(){return!0===a(this.autocomplete)}handleInputChange(t){this.searchString=t.detail.value,this.isOpen||this.toggleSelectUl()}selectItem(t,e){t&&t.disabled||(this.itemsList=this.mapSelectedItemToItemsArray(),this.itemsList=this.itemsList.map((s=>(s.selected=!1,s.id===(null==t?void 0:t.id)&&(s.selected=e),s))),this.selectedItem=this.itemsList.find((t=>t.selected)),this.emitOptionSelect(),this.searchString&&(this.searchString=null))}arrowsSelectNav(t,e){if(![l.ARROW_DOWN,l.ARROW_UP].includes(t.key))return;let s;t.preventDefault(),t.stopPropagation(),this.isOpen||this.toggleSelectUl(),t.key===l.ARROW_DOWN?s=e+1===this.itemsList.length?0:e+1:t.key===l.ARROW_UP&&(s=e<=0?this.itemsList.length-1:e-1),this.focusSelectItem(s)}focusSelectItem(t){const e=this.element.querySelector(`#${this.htmlid}_${t}`);e&&e.focus()}toggleSelectUl(t=!1){this.disabled||this.readonly||(this.isOpen?(document.removeEventListener("click",this.handleSelectFocus),document.removeEventListener("keyup",this.handleSelectFocus),t&&this.element.querySelector(`#${this.htmlid}_input`).focus()):(document.addEventListener("click",this.handleSelectFocus),document.addEventListener("keyup",this.handleSelectFocus)),this.isOpen=!this.isOpen)}handleInputClick(t){t.composedPath().find((t=>t.classList&&t.classList.contains("reset-icon")))?t.stopPropagation():this.toggleSelectUl()}handleSelectFocus(t){if(t instanceof KeyboardEvent&&t.key===l.ESC)return t.stopPropagation(),this.toggleSelectUl(!0);t instanceof KeyboardEvent&&t.key!==l.TAB&&t.key!==l.ENTER||o(h()).find((t=>"z-input"===t.nodeName.toLowerCase()&&t.id===`${this.htmlid}_input`))||this.toggleSelectUl(t instanceof MouseEvent)}scrollToLetter(t){const e=this.itemsList.find((e=>e.name.charAt(0)===t));e&&this.focusSelectItem(this.itemsList.indexOf(e))}renderInput(){return e("z-input",{id:`${this.htmlid}_input`,htmlid:`${this.htmlid}_input`,placeholder:this.placeholder,value:!this.isOpen&&this.selectedItem?this.selectedItem.name.replace(/<[^>]+>/g,""):null,label:this.label,"aria-label":this.ariaLabel,icon:this.isOpen?"caret-up":"caret-down",hasclearicon:this.hasAutocomplete(),message:!1,disabled:this.disabled,readonly:this.readonly||!this.hasAutocomplete()&&this.isOpen,status:this.isOpen?void 0:this.status,autocomplete:"off",onClick:t=>{this.handleInputClick(t)},onKeyUp:t=>{13!==t.keyCode&&t.preventDefault(),n(t,this.toggleSelectUl)},onKeyDown:t=>this.arrowsSelectNav(t,this.selectedItem?this.itemsList.indexOf(this.selectedItem):-1),onInputChange:t=>{this.handleInputChange(t)},onKeyPress:t=>{this.hasAutocomplete()||(t.preventDefault(),this.scrollToLetter(String.fromCharCode(t.keyCode)))}})}renderSelectUl(){var t;return e("div",{class:this.isOpen?"open":"closed",tabindex:"-1"},e("div",{class:"ul-scroll-wrapper",tabindex:"-1"},e("z-list",{role:"listbox",tabindex:this.disabled||this.readonly||!this.isOpen?-1:0,id:this.htmlid,"aria-activedescendant":null===(t=this.selectedItem)||void 0===t?void 0:t.id,"aria-multiselectable":!1,class:{disabled:this.disabled,readonly:this.readonly,filled:!!this.selectedItem,[`input-${this.status}`]:!this.isOpen&&!!this.status}},this.hasGroupItems?this.renderSelectGroupItems():this.renderSelectUlItems())))}renderSelectUlItems(){return this.itemsList.length?this.itemsList.map(((t,s,i)=>e("z-list-element",{clickable:!t.disabled,disabled:t.disabled,dividerType:i.length===s+1?r.HEADER:r.ELEMENT,role:"option",tabindex:t.disabled||!this.isOpen?-1:0,"aria-selected":!!t.selected,id:`${this.htmlid}_${s}`,onClickItem:()=>this.selectItem(t,!0),onKeyDown:t=>this.arrowsSelectNav(t,s)},e("span",{class:{selected:!!t.selected},innerHTML:t.name})))):this.renderNoSearchResults()}renderSelectGroupItems(){if(!this.itemsList.length)return this.renderNoSearchResults();const t=this.itemsList.reduce(((t,s,i,l)=>{var c;const{category:a}=s,o=e("z-list-element",{clickable:!s.disabled,disabled:s.disabled,dividerType:l.length===i+1?r.HEADER:r.ELEMENT,role:"option",tabindex:s.disabled||!this.isOpen?-1:0,"aria-selected":!!s.selected,id:`${this.htmlid}_${i}`,onClickItem:()=>this.selectItem(s,!0),onKeyDown:t=>this.arrowsSelectNav(t,i)},e("span",{class:{selected:!!s.selected},innerHTML:s.name}));return t[a]=null!==(c=t[a])&&void 0!==c?c:[],t[a].push(o),t}),{});return Object.entries(t).map((([t,s])=>e("z-list-group",{"divider-type":r.ELEMENT},e("z-body",{class:"z-list-group-title",level:3,slot:"header-title",variant:"semibold"},t),s.map((t=>t)))))}renderNoSearchResults(){return e("z-list-element",{color:"blue500",class:"no-results"},e("z-icon",{name:"multiply-circle",fill:"blue500"}),this.noresultslabel)}renderMessage(){if(!1!==a(this.message))return e("z-input-message",{message:!0===a(this.message)?void 0:this.message,status:this.status})}render(){return e("div",{class:"select-wrapper"},this.renderInput(),this.renderSelectUl(),this.renderMessage())}get element(){return i(this)}static get watchers(){return{items:["watchItems"]}}};d.style=".sc-z-select-h{display:inline-block;width:inherit;color:var(--color-text02);font-family:var(--font-family-sans);font-size:var(--font-size-3);font-weight:var(--font-rg)}.select-wrapper.sc-z-select>z-input.sc-z-select{width:100%}.select-wrapper.sc-z-select>div.sc-z-select{position:relative}.select-wrapper.sc-z-select>div.closed.sc-z-select{overflow:hidden;height:0}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select{position:absolute;width:100%;box-sizing:border-box;padding:calc(var(--space-unit) * 0.5) var(--space-unit);border:var(--border-size-small) solid var(--gray200);border-top:none;background:var(--color-surface01);outline:none}.select-wrapper.sc-z-select .closed.sc-z-select .ul-scroll-wrapper.sc-z-select{z-index:10}.select-wrapper.sc-z-select .open.sc-z-select .ul-scroll-wrapper.sc-z-select{z-index:20}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select{position:relative;overflow:auto;max-height:240px;padding:calc(var(--space-unit) * 0.5);outline:none;scrollbar-color:var(--color-primary01) transparent}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar{width:10px;background:linear-gradient(to right, transparent 0 3px, var(--gray200) 3px 7px, transparent 7px 10px);border-radius:var(--border-radius)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar-track{background-color:transparent}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar-thumb{width:10px;background-color:var(--color-primary01);border-radius:var(--border-radius)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar-thumb:hover{background-color:var(--color-hover-primary)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select span.sc-z-select{display:block;padding:0 calc(var(--space-unit) * 1.5)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select span.selected.sc-z-select{font-weight:bold}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select .no-results.sc-z-select z-icon.sc-z-select{margin-right:var(--space-unit)}.z-list-group-title.sc-z-select{color:var(--gray800)}";export{p as z_input_label,d as z_select}