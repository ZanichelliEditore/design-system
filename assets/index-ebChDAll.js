import{s as w,g as m}from"./chunk-L4EGOTBX-lo-pZyle.js";import"./entry-preview-Cx7Tr7Nx.js";import{d as P,H as x,c as l,h as g,a as y}from"./index-BZ0rSFNp.js";import{P as o,K as _,e as v}from"./index-BBy8evlc.js";import{c as T,f as b,g as H,i as B}from"./utils-D8xbZiRf.js";const k=':host{position:fixed;display:none;max-width:calc(100% - var(--grid-margin) * 2);max-height:calc(100% - var(--grid-margin) * 2);padding:var(--z-popover-padding, 0);background:var(--z-popover-theme--surface, var(--color-surface01));border-radius:var(--border-radius-small);color:var(--z-popover-theme--text, var(--color-default-text));fill:currentcolor;filter:var(--z-popover-shadow-filter, drop-shadow(0 1px 2px var(--shadow-color-base)));text-align:center;visibility:hidden;}:host([open]:not([open="false"])[current-position]){display:block}:host([center][current-position="top"]),:host([center][current-position="bottom"]){transform:translateX(-50%)}:host([center][current-position="right"]),:host([center][current-position="left"]){transform:translateY(-50%)}:host([current-position^="top"]){margin:0 0 var(--space-unit)}:host([current-position^="bottom"]){margin:var(--space-unit) 0 0}:host([current-position^="left"]){margin:0 var(--space-unit) 0 0}:host([current-position^="right"]){margin:0 0 0 var(--space-unit)}:host([current-position])::before{--arrow-size:6px;--arrow-edge-offset:calc(100% - var(--space-unit) - (var(--arrow-size) / 2));--arrow-center-x-offset:calc(50% - (var(--arrow-size) / 2));--arrow-center-y-offset:calc(100% - (var(--arrow-size) / 2));position:absolute;display:block;width:var(--arrow-size);height:var(--arrow-size);background:var(--z-popover-theme--surface, var(--color-surface01));content:"";transform:rotate(45deg)}:host([show-arrow="false"])::before,:host(:not([show-arrow]))::before{display:none}:host([current-position^="top"])::before{top:var(--arrow-center-y-offset)}:host([current-position^="bottom"])::before{bottom:var(--arrow-center-y-offset)}:host([current-position="top"])::before,:host([current-position="bottom"])::before{right:var(--arrow-edge-offset)}:host([current-position="right"])::before,:host([current-position="left"])::before{bottom:var(--arrow-edge-offset)}:host([current-position="right"])::before{right:var(--arrow-center-y-offset)}:host([current-position="left"])::before{left:var(--arrow-center-y-offset)}:host([current-position="top_right"])::before,:host([current-position="bottom_right"])::before{right:var(--arrow-edge-offset)}:host([current-position="top_left"])::before,:host([current-position="bottom_left"])::before{left:var(--arrow-edge-offset)}:host([current-position="right_top"])::before,:host([current-position="left_top"])::before{top:var(--arrow-edge-offset)}:host([current-position="right_top"])::before,:host([current-position="right_bottom"])::before{right:var(--arrow-center-y-offset)}:host([current-position="left_top"])::before,:host([current-position="left_bottom"])::before{left:var(--arrow-center-y-offset)}:host([current-position="right_bottom"])::before,:host([current-position="left_bottom"])::before{bottom:var(--arrow-edge-offset)}:host([center][current-position="top"])::before,:host([center][current-position="bottom"])::before{right:auto;left:var(--arrow-center-x-offset)}:host([center][current-position="right"])::before,:host([center][current-position="left"])::before{top:var(--arrow-center-x-offset);bottom:auto}',f=class extends x{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.positionChange=l(this,"positionChange",7),this.openChange=l(this,"openChange",7),this.position=o.TOP,this.open=!1,this.showArrow=!1,this.center=!1,this.closable=!0,this.spaceTolerance=3}closePopoverWithKeyboard(e){this.closable&&e.key===_.ESC&&(this.open=!1)}handleOutsideClick(e){const t=e.target;!this.closable||!this.open||T(this.host,t)||(T(this.boundElement,t)&&e.stopPropagation(),this.open=!1)}validatePosition(e){(!Object.values(o).includes(e)||e===o.AUTO)&&(e=o.TOP,this.position=e),this.currentPosition=e,this.open&&this.setPosition()}onOpen(){if(cancelAnimationFrame(this.animationFrameRequestId),this.openChange.emit({open:this.open}),!this.open){Object.assign(this.host.style,{top:"auto",right:"auto",bottom:"auto",left:"auto",maxWidth:"",maxHeight:"",visibility:"hidden"}),this.currentPosition=void 0;return}const e=()=>{this.open&&(this.setPosition(),this.animationFrameRequestId=requestAnimationFrame(e))};setTimeout(()=>{e()},0)}onBindingChange(){this.findBoundElement()}get offsetModifier(){return this.center?.5:0}findBoundElement(){typeof this.bindTo=="string"?this.boundElement=this.host.ownerDocument.querySelector(this.bindTo):this.bindTo?this.boundElement=this.bindTo:this.boundElement=this.host.parentElement}hasCenteredHorizontalSpace(e,t,n,r){const s=(n-r)*(1-this.offsetModifier);return this.center?t>=s-this.spaceTolerance&&e>=s-this.spaceTolerance:t>=s-this.spaceTolerance}hasCenteredVerticalSpace(e,t,n,r){const s=(n-r)*(1-this.offsetModifier);return this.center?e>=s-this.spaceTolerance&&t>=s-this.spaceTolerance:t>=s-this.spaceTolerance}hasEnoughSideSpace(e,t,n,r){return e>=t-n*(1-r)-this.spaceTolerance}getOptimalPopoverPosition(e,t){const n=this.host.offsetWidth,r=this.host.offsetHeight,s=this.boundElement.getBoundingClientRect().width,i=this.boundElement.getBoundingClientRect().height,c=this.offsetModifier,d=p=>{switch(p){case o.TOP:return t.top>=r-this.spaceTolerance&&this.hasCenteredHorizontalSpace(t.left,t.right,n,s);case o.TOP_RIGHT:return t.top>=r&&this.hasEnoughSideSpace(t.right,n,s,c);case o.TOP_LEFT:return t.top>=r&&this.hasEnoughSideSpace(t.left,n,s,c);case o.RIGHT:return t.right>=n&&this.hasCenteredVerticalSpace(t.top,t.bottom,r,i);case o.RIGHT_BOTTOM:return t.right>=n&&this.hasEnoughSideSpace(t.bottom,r,i,c);case o.RIGHT_TOP:return t.right>=n&&this.hasEnoughSideSpace(t.top,r,i,c);case o.BOTTOM:return t.bottom>=r&&this.hasCenteredHorizontalSpace(t.left,t.right,n,s);case o.BOTTOM_LEFT:return t.bottom>=r&&this.hasEnoughSideSpace(t.left,n,s,c);case o.BOTTOM_RIGHT:return t.bottom>=r&&this.hasEnoughSideSpace(t.right,n,s,c);case o.LEFT:return t.left>=n&&this.hasCenteredVerticalSpace(t.top,t.bottom,r,i);case o.LEFT_TOP:return t.left>=n&&this.hasEnoughSideSpace(t.top,r,i,c);case o.LEFT_BOTTOM:return t.left>=n&&this.hasEnoughSideSpace(t.bottom,r,i,c);default:return!1}};if(d(e))return e;const h=f.positionOrder,a=h.indexOf(e);if(a===-1)return e;for(let p=1;p<h.length;p++){const E=(a+p)%h.length,u=h[E];if(d(u))return u}return this.findBestFallbackPosition(t)}findBestFallbackPosition(e){const t=e.right>=e.left?o.RIGHT:o.LEFT,n=e.bottom>=e.top?o.BOTTOM:o.TOP,r=Math.max(e.right,e.left),s=Math.max(e.bottom,e.top),i=s>=r?n:t;let c=!1;if(i===n){const h=Math.min(e.right,e.left);c=r>=h*2}else{const h=Math.min(e.bottom,e.top);c=s>=h*2}return c?`${i}_${i===n?t:n}`:i}calculateAvailableSpace(){const e=this.boundElement.getBoundingClientRect();if(this.lastBoundRect&&this.lastBoundRect.x===e.x&&this.lastBoundRect.y===e.y&&this.lastBoundRect.width===e.width&&this.lastBoundRect.height===e.height&&this.cachedAvailableSpace)return this.cachedAvailableSpace;this.lastBoundRect=e;const t=b(this.boundElement),n=t.getBoundingClientRect(),r=t!==this.boundElement.ownerDocument.documentElement,s=this.boundElement.ownerDocument.documentElement.clientWidth,i=this.boundElement.ownerDocument.documentElement.clientHeight,c=8,d=r?n.top:0,h=r?s-n.right:0,a=r?i-n.bottom:0,p=r?n.left:0;return this.cachedAvailableSpace={top:e.top-d-c,right:s-e.right-h-c,bottom:i-e.bottom-a-c,left:e.left-p-c},this.cachedAvailableSpace}calculateElementOffsets(e){const t=e.getBoundingClientRect(),n=e.ownerDocument.documentElement.clientWidth,r=e.ownerDocument.documentElement.clientHeight;return{top:t.top,right:n-t.right,bottom:r-t.bottom,left:t.left}}applyPositionStyles(e,t){const n=this.boundElement.offsetWidth,r=this.boundElement.offsetHeight,s=8,i=this.offsetModifier,c=this.showArrow&&this.center?8:0,d=this.host.style,h=this.calculateElementOffsets(this.boundElement);let a,p;switch(e){case o.TOP:case o.TOP_RIGHT:d.bottom=`${h.bottom+r}px`,d.left=`${h.left+n*i-(e===o.TOP_RIGHT?c:0)}px`,p=t.top-s,e===o.TOP_RIGHT&&(a=t.right+n*i);break;case o.TOP_LEFT:d.right=`${h.right+n*i-c}px`,d.bottom=`${h.bottom+r}px`,a=t.left+n*i,p=t.top-s;break;case o.BOTTOM:case o.BOTTOM_RIGHT:d.top=`${h.top+r}px`,d.left=`${h.left+n*i-(e===o.BOTTOM_RIGHT?c:0)}px`,p=t.bottom-s,e===o.BOTTOM_RIGHT&&(a=t.right+n*i);break;case o.BOTTOM_LEFT:d.top=`${h.top+r}px`,d.right=`${h.right+n*i-c}px`,a=t.left+n*i,p=t.bottom-s;break;case o.RIGHT:case o.RIGHT_BOTTOM:d.top=`${h.top+r*i-(e===o.RIGHT_BOTTOM?c:0)}px`,d.left=`${h.left+n}px`,a=t.right-s,e===o.RIGHT?p=t.top+t.bottom+r:p=t.bottom+r*i;break;case o.RIGHT_TOP:d.bottom=`${h.bottom+r*i-c}px`,d.left=`${h.left+n}px`,a=t.right-s,p=t.top+r*i;break;case o.LEFT:case o.LEFT_BOTTOM:d.top=`${h.top+r*i-(e===o.LEFT_BOTTOM?c:0)}px`,d.right=`${h.right+n}px`,a=t.left-s,e===o.LEFT_BOTTOM&&(p=t.bottom+r*i);break;case o.LEFT_TOP:d.right=`${h.right+n}px`,d.bottom=`${h.bottom+r*i-c}px`,a=t.left-s,p=t.top+r*i;break}H()!==v.MOBILE&&Object.assign(d,{maxWidth:a?`${a}px`:"",maxHeight:p?`${p}px`:""})}setPosition(){if(!this.boundElement)return;if(!B(this.boundElement,b(this.boundElement))){this.open=!1;return}Object.assign(this.host.style,{top:"auto",right:"auto",bottom:"auto",left:"auto",maxWidth:"",maxHeight:"",visibility:"hidden"});const e=this.calculateAvailableSpace(),t=this.getOptimalPopoverPosition(this.position,e);this.applyPositionStyles(t,e),this.currentPosition=t,this.positionChange.emit({position:this.currentPosition}),this.host.style.visibility="visible"}componentWillLoad(){this.validatePosition(this.position)}componentDidLoad(){this.findBoundElement(),this.open&&this.onOpen()}disconnectedCallback(){cancelAnimationFrame(this.animationFrameRequestId)}render(){return g(y,{key:"1d30a74c50b34c9df8632bd3c3b7f183fc091658","current-position":this.currentPosition},g("slot",{key:"8dda69b775414db54dd5eef05c46c4320b9038e8"}))}get host(){return this}static get watchers(){return{position:["validatePosition"],open:["onOpen"],bindTo:["onBindingChange"]}}static get style(){return k}};f.positionOrder=[o.TOP,o.TOP_RIGHT,o.TOP_LEFT,o.RIGHT,o.RIGHT_BOTTOM,o.RIGHT_TOP,o.BOTTOM,o.BOTTOM_LEFT,o.BOTTOM_RIGHT,o.LEFT,o.LEFT_TOP,o.LEFT_BOTTOM];P(f,[1,"z-popover",{position:[1544],open:[1540],bindTo:[8,"bind-to"],showArrow:[516,"show-arrow"],center:[516],closable:[4],currentPosition:[32]},[[8,"keyup","closePopoverWithKeyboard"],[18,"click","handleOutsideClick"]],{position:["validatePosition"],open:["onOpen"],bindTo:["onBindingChange"]}]);const O={schemaVersion:"1.0.0",modules:[{kind:"javascript-module",path:"",declarations:[{kind:"class",name:"ZPopover",tagName:"z-popover",customElement:!0,members:[{kind:"field",name:"position",type:"any",description:"The preferred position to render the popover.\nThe popover will automatically search another position if not enough space is available for the preferred position.\nIf the preferred position is not available, it will try to find the best position starting from `TOP` and going clockwise.",default:"PopoverPosition.TOP"},{kind:"field",name:"open",type:"boolean",description:"The open state of the popover.",default:"false"},{kind:"field",name:"bindTo",type:"any",description:`The selector or the element bound with the popover.
If string css selector is provided make sure to use a valid selector.`},{kind:"field",name:"showArrow",type:"boolean",description:"Whether to show popover's arrow.",default:"false"},{kind:"field",name:"center",type:"boolean",description:'Whether to center the popup on the main side (according to "position").',default:"false"},{kind:"field",name:"closable",type:"boolean",description:"If true, the popover can be closed by clicking outside of it or pressing the escape key.\nOtherwise, it will be closed only programmatically (by setting `open` to `false`).",default:"true"}],events:[{kind:"event",name:"positionChange",description:"Fired when the position changes."},{kind:"event",name:"openChange",description:"Open change event."}],cssProperties:[{name:"--z-popover-theme--surface",description:"background color of the popover."},{name:"--z-popover-theme--text",description:"foreground color of the popover."},{name:"--z-popover-padding",description:"padding of the popover."},{name:"--z-popover-shadow-filter",description:"drop-shadow filter of the popover. Defaults to `drop-shadow(0 1px 2px var(--shadow-color-base))`."}]}],exports:[{kind:"js",name:"ZPopover",declaration:{name:"ZPopover",module:"src/components/z-popover/index.tsx"}},{kind:"custom-element-definition",name:"z-popover",declaration:{name:"ZPopover",module:"src/components/z-popover/index.tsx"}}]}]};w({...m()||{},...O,modules:[...(m()||{}).modules||[],...O.modules]});
