import{x as E}from"./lit-element-DGXdXVoE.js";import{C as l,i as u,c as b,K as n,L as f}from"./index-BBy8evlc.js";import"./index-DSmxu1eR.js";import"./index-Ce4wmndo.js";import"./index-Cn75BSrF.js";import"./index-C8SXK3gz.js";import{s as $,g as v}from"./chunk-L4EGOTBX-lo-pZyle.js";import"./entry-preview-Cx7Tr7Nx.js";import{d as R,H as _,c as O,h as a}from"./index-BZ0rSFNp.js";import{r as N,e as D}from"./utils-D8xbZiRf.js";import"./index-Vbx4JCSw.js";import"./index-BlLJK3Fc.js";import"./index-DrFu-skq.js";import"./breakpoints-p3CVLX0Q.js";const V=".z-label{display:block;padding-bottom:var(--space-unit);color:var(--color-default-text);font-family:var(--font-family-sans);font-size:var(--font-size-1);font-weight:var(--font-sb);text-align:left;text-transform:uppercase}",M=V+`:host{display:block;color:var(--color-form-default-text);fill:var(--color-form-default-icon);font-family:var(--font-family-sans)}:host>div.fixed{position:relative}:host>div>.header{position:relative;z-index:10;display:flex;min-height:42px;align-items:center;justify-content:space-between;padding:0 calc(var(--space-unit) * 1.5);border:var(--border-size-small) solid var(--color-form-surface04);margin:0;background-color:var(--color-form-background);border-radius:var(--border-radius-small);cursor:pointer}:host([size="small"])>div>.header{min-height:34px;font-size:var(--font-size-2)}:host([size="x-small"])>div>.header{min-height:30px;font-size:var(--font-size-2)}:host>div>.header:hover{outline:var(--border-size-medium) solid var(--color-form-surface04);outline-offset:-2px}:host>div>div.header:focus:focus-visible{z-index:16;box-shadow:var(--shadow-focus-primary);outline:none}:host>div>.header>span.body-3>span{font-weight:var(--font-sb)}:host>div>.header>z-icon{fill:var(--color-form-default-icon);transform:rotate(360deg);transition:all 200ms linear}:host>div>.header>z-icon.small,:host>div>.header>z-icon.x-small{--z-icon-width:16px;--z-icon-height:16px}:host>div.open>.header{border:var(--border-size-small) solid var(--color-form-active-primary);border-radius:var(--border-radius-small) var(--border-radius-small) 0 0}:host>div.disabled{pointer-events:none}:host>div.disabled .header{border-color:var(--color-form-disabled03);fill:var(--color-form-disabled01-icon)}:host>div.disabled .header>span.body-3{color:var(--color-form-disabled03)}:host>div.disabled .header>z-icon:last-child{fill:var(--color-form-disabled01-icon)}:host>div.open>.header>z-icon{fill:var(--color-form-default-icon);transform:rotate(180deg);transition:all 200ms linear}:host>div>div.open-combo-data{display:none}:host>div.open>div.open-combo-data{position:relative;z-index:12;display:block;padding:var(--space-unit) calc(var(--space-unit) * 2);border:var(--border-size-small) solid var(--color-form-surface03);border-top:0;background-color:var(--color-form-background);border-radius:0;box-shadow:var(--shadow-2)}:host .open .open-combo-data z-input .z-label{color:var(--color-form-default-text)}:host>div.open>div.open-combo-data>div>div{overflow:auto;max-height:235px;padding:0;padding-left:var(--space-unit);margin-left:calc(var(--space-unit) * -1);}:host>div.open>div.open-combo-data>z-input{width:100%;margin-bottom:calc(var(--space-unit) * 2)}:host>div.open>div.open-combo-data>div>div>ul{max-height:235px;padding:0 calc(var(--space-unit) * 0.5);margin:0}:host .open-combo-data z-list-element{--background-color-list-element:var(--color-form-background);--background-hover-color-list-element:var(--color-form-surface03);--background-active-color-list-element:var(--color-form-surface03)}::-webkit-scrollbar{width:6px;background:linear-gradient(to right, transparent 0 1px, var(--gray200) 1px 5px, transparent 5px 6px)}::-webkit-scrollbar-thumb{background-color:var(--color-primary01)}::-webkit-scrollbar-thumb:hover{background-color:var(--color-hover-primary)}@supports not selector(::-webkit-scrollbar-track){:host{scrollbar-color:var(--color-primary01) transparent}}:host>div.open>z-input{position:relative;z-index:1;width:238px;margin:0 calc(var(--space-unit) * 2);color:var(--color-form-active-primary)}:host>div.open>div.open-combo-data>div>div.search{overflow:hidden;max-height:none;margin-top:0}:host>div.open>div.open-combo-data>div>div.search>ul{overflow:auto;max-height:180px;padding:var(--space-unit) calc(var(--space-unit) * 2)}:host .open .open-combo-data .search .no-results{display:flex;align-items:center;column-gap:var(--space-unit)}:host>.open>.open-combo-data .search .close-search{display:flex;justify-content:center}:host>div.open>div.open-combo-data>div>div.search .close-search>a{display:inline-block;height:44px;color:var(--color-form-active-primary);cursor:pointer;font-size:14px;font-weight:var(--font-sb);line-height:44px;text-align:center;text-transform:uppercase}:host>div.open>div.open-combo-data>div>div.search .close-search>a:focus:focus-visible{box-shadow:var(--shadow-focus-primary);outline:none}:host>div.open>div.open-combo-data>div>div.check-all-wrapper{padding:calc(var(--space-unit) * 2) calc(var(--space-unit) * 0.5) calc(var(--space-unit) * 2)
    calc(var(--space-unit) * 1.5);border-bottom:var(--border-size-small) solid var(--gray800);margin-bottom:var(--space-unit);margin-left:calc(var(--space-unit) * -1);text-align:left}:host([size="small"])>div.open>div.open-combo-data>div>div.check-all-wrapper{padding:calc(var(--space-unit) * 1.5) calc(var(--space-unit) * 0.5)}:host([size="x-small"])>div.open>div.open-combo-data>div>div.check-all-wrapper{padding:var(--space-unit) calc(var(--space-unit) * 0.5)}`,T=class extends _{watchItems(){this.itemsList=typeof this.items=="string"?JSON.parse(this.items):this.items,this.selectedCounter=this.itemsList.filter(e=>e.checked).length,this.updateRenderItemsList()}watchSearchValue(){this.filterItems(this.searchValue)}watchCheckboxes(){this.checkboxes.forEach((e,t)=>e.setAttribute("tabindex",t===0?"0":"-1"))}emitComboboxChange(){this.comboboxChange.emit({id:this.inputid,items:this.itemsList})}constructor(){super(),this.__registerHost(),this.__attachShadow(),this.comboboxChange=O(this,"comboboxChange",7),this.inputid=`combo-${N()}`,this.disabled=!1,this.hassearch=!1,this.noresultslabel="Nessun risultato",this.isopen=!1,this.isfixed=!1,this.hascheckall=!1,this.checkalltext="Seleziona tutti",this.uncheckalltext="Deseleziona tutti",this.maxcheckableitems=0,this.size=l.BIG,this.renderItemsList=[],this.checkboxes=[],this.itemsList=[],this.inputType=u.TEXT,this.toggleComboBox=this.toggleComboBox.bind(this),this.closeFilterItems=this.closeFilterItems.bind(this)}componentWillLoad(){this.watchItems()}componentWillRender(){this.selectedCounter=this.itemsList.filter(e=>e.checked).length}componentDidRender(){const e=this.getAllCheckboxes();JSON.stringify(e)!==JSON.stringify(this.checkboxes)&&(this.checkboxes=e)}getItemId(e){return`combo-checkbox-${this.inputid}-${e.id}`}getCheckboxClass(){return`combo-item-checkbox-input-${this.inputid}`}getAllCheckboxes(){return Array.from(this.element.shadowRoot.querySelectorAll(`.${this.getCheckboxClass()} input:not([disabled])`))}getControlToListSize(){switch(this.size){case l.X_SMALL:return b.SMALL;case l.SMALL:return b.MEDIUM;default:return b.LARGE}}handleSelectArrowsNavigation(e,t){if(![n.ARROW_DOWN,n.ARROW_UP].includes(e.key)||!this.isopen)return;e.preventDefault(),e.stopPropagation();const i=this.element.shadowRoot.querySelector(`#${t}`),s=this.checkboxes;if(!s.length)return;const o=i?s.indexOf(i):null,r=0,d=s.length-1;let c=null;e.key===n.ARROW_DOWN?c=o===null||o===d?s[r]:s[o+1]:e.key===n.ARROW_UP&&(c=o===null||o===r?s[d]:s[o-1]),this.focusComboboxItem(c)}handleHeaderKeyboardEvent(e){e.key===n.SPACE&&e.preventDefault(),(e.key===n.ARROW_DOWN&&!this.isopen||e.key===n.ARROW_UP&&this.isopen)&&this.toggleComboBox()}handleCheckboxFocus(e){this.focusedItemId=e}focusComboboxItem(e){this.checkboxes.forEach(function(t){t.setAttribute("tabindex","-1")}),e.setAttribute("tabindex","0"),e.focus()}updateRenderItemsList(){this.searchValue?this.filterItems(this.searchValue):this.resetRenderItemsList()}resetRenderItemsList(){const e=[];this.itemsList.forEach(t=>{e.push(Object.assign({},t))}),this.renderItemsList=e}filterItems(e){if(!e)return this.closeFilterItems();this.resetRenderItemsList(),this.renderItemsList=this.renderItemsList.filter(t=>{const i=t.name.toUpperCase().indexOf(e.toUpperCase()),s=i+e.length,o=t.name.substring(0,i)+"<strong>"+t.name.substring(i,s)+"</strong>"+t.name.substring(s,t.name.length);return t.name=o,i>=0})}checkAll(e=!0){this.itemsList=this.itemsList.map(t=>Object.assign(Object.assign({},t),{checked:e})),this.resetRenderItemsList(),this.emitComboboxChange()}closeFilterItems(){this.searchValue="",this.resetRenderItemsList()}toggleComboBox(){this.isopen=!this.isopen}getComboboxA11yAttributes(e){const t="combobox",i=this.isopen?"true":"false",s=this.isopen?this.focusedItemId:"",o=`${this.inputid}_list`;return e?{role:t,"html-aria-expanded":i,"html-aria-activedescendant":s,"html-aria-controls":o}:{role:t,"aria-expanded":i,"aria-activedescendant":s,"aria-controls":o}}renderHeader(){return a("div",{class:"header",onClick:()=>this.toggleComboBox(),onKeyDown:e=>{this.handleHeaderKeyboardEvent(e)},onKeyUp:e=>D(e,this.toggleComboBox),role:"button",tabindex:0,"aria-controls":"open-combo-data","aria-expanded":this.isopen?"true":"false"},a("span",{class:"body-3"},this.label,a("span",null,this.selectedCounter>0&&` (${this.selectedCounter})`)),a("z-icon",{name:"caret-down",class:this.size}))}renderContent(){return a("div",{id:"open-combo-data",class:"open-combo-data"},this.hassearch&&this.renderSearchInput(),this.hassearch?null:a("span",Object.assign({},this.getComboboxA11yAttributes(!1))),a("div",{role:"listbox","aria-label":this.label,"aria-multiselectable":"true",id:`${this.inputid}_list`,"aria-owns":Array.from(this.element.shadowRoot.querySelectorAll("[role='option']")).map(e=>e.id).join(" ")},this.hascheckall&&this.renderCheckAll(),this.renderItems()))}renderItems(){return a("div",{class:this.searchValue&&"search",tabIndex:-1,role:"presentation"},this.renderList(this.renderItemsList))}renderItem(e,t,i){const s=!e.checked&&this.maxcheckableitems&&this.selectedCounter>=this.maxcheckableitems;return a("z-list-element",{id:`option-${e.id}`,htmlTabindex:null,dividerType:t!==i-1?f.ELEMENT:f.NONE,size:this.getControlToListSize(),role:s?"presentation":"option","aria-selected":e.checked?"true":"false"},a("z-input",{type:u.CHECKBOX,checked:e.checked,htmlid:this.getItemId(e),label:e.name,class:this.getCheckboxClass(),disabled:s,size:this.size===l.X_SMALL?l.SMALL:this.size,onKeyDown:o=>this.handleSelectArrowsNavigation(o,this.getItemId(e)),onInputCheck:o=>{this.itemsList=this.itemsList.map(r=>(e.id===r.id&&(r.checked=o.detail.checked),r)),this.updateRenderItemsList(),this.emitComboboxChange()},onInputFocus:o=>this.handleCheckboxFocus(o.detail.id)}))}renderList(e){if(e)return!e.length&&this.searchValue?this.renderNoSearchResults():this.hasgroupitems?this.renderGroups(e):a("ul",{role:"presentation"},e.map((t,i)=>this.renderItem(t,i,e.length)))}renderGroups(e){const t=e.reduce((s,o,r)=>{var d;const{category:c}=o,A=this.renderItem(o,r,e.length);return s[c]=(d=s[c])!==null&&d!==void 0?d:[],s[c].push(A),s},{}),i=Object.entries(t).map(([s,o])=>a("z-list-group",{"divider-type":f.ELEMENT},a("span",{class:"body-3-sb z-list-group-title",slot:"header-title"},s),o.map(r=>r)));return a("ul",{role:"presentation"},i)}renderNoSearchResults(){return a("div",{class:"no-results"},a("span",null,this.noresultslabel))}renderSearchInput(){return a("z-input",Object.assign({htmlid:`${this.inputid}_search`,label:this.searchlabel,placeholder:this.searchplaceholder,htmltitle:this.searchtitle,type:this.inputType,value:this.searchValue,message:!1,size:this.size,"html-aria-autocomplete":"list"},this.getComboboxA11yAttributes(!0),{onKeyUp:e=>{e.key===n.ESC&&this.closeFilterItems(),this.handleSelectArrowsNavigation(e)},onInputChange:e=>{this.searchValue=e.detail.value}}))}renderCheckAll(){if(this.searchValue)return;const e=`combo-checkbox-${this.inputid}-check-all`,t=this.selectedCounter===this.itemsList.length;return a("div",{class:"check-all-wrapper",id:"option-check-all",role:"option"},a("z-input",{type:u.CHECKBOX,checked:t,htmlid:e,class:this.getCheckboxClass(),label:t?this.uncheckalltext:this.checkalltext,disabled:this.maxcheckableitems&&this.maxcheckableitems<this.itemsList.length,size:this.size===l.X_SMALL?l.SMALL:this.size,onKeyDown:i=>this.handleSelectArrowsNavigation(i,e),onInputCheck:i=>this.checkAll(i.detail.checked),onInputFocus:i=>this.handleCheckboxFocus(i.detail.id)}))}render(){return a("div",{key:"6a3c686348ed9f1e4182ee54d74f4f3067bf3e95","data-action":`combo-${this.inputid}`,class:{open:this.isopen,fixed:this.isfixed,disabled:this.disabled},id:this.inputid},this.renderHeader(),!this.disabled&&this.renderContent())}get element(){return this}static get watchers(){return{items:["watchItems"],searchValue:["watchSearchValue"],checkboxes:["watchCheckboxes"]}}static get style(){return M}};R(T,[1,"z-combobox",{inputid:[1],items:[1],label:[1],disabled:[516],hassearch:[4],searchlabel:[1],searchplaceholder:[1],searchtitle:[1],noresultslabel:[1],isopen:[1028],isfixed:[4],hascheckall:[4],checkalltext:[1],uncheckalltext:[1],maxcheckableitems:[2],hasgroupitems:[4],size:[8],searchValue:[32],selectedCounter:[32],renderItemsList:[32],focusedItemId:[32],checkboxes:[32]},void 0,{items:["watchItems"],searchValue:["watchSearchValue"],checkboxes:["watchCheckboxes"]}]);const x={schemaVersion:"1.0.0",modules:[{kind:"javascript-module",path:"",declarations:[{kind:"class",name:"ZCombobox",tagName:"z-combobox",customElement:!0,members:[{kind:"field",name:"inputid",type:"string",description:"input unique id",default:"`combo-${randomId()}`"},{kind:"field",name:"items",type:"string",description:"list items array"},{kind:"field",name:"label",type:"string",description:"label text"},{kind:"field",name:"disabled",type:"boolean",description:"the combobox is disabled",default:"false"},{kind:"field",name:"hassearch",type:"boolean",description:"show search input flag (optional)",default:"false"},{kind:"field",name:"searchlabel",type:"string",description:"search input label text (optional)"},{kind:"field",name:"searchplaceholder",type:"string",description:"search input placeholder text (optional)"},{kind:"field",name:"searchtitle",type:"string",description:"search input title text (optional)"},{kind:"field",name:"noresultslabel",type:"string",description:"no result text message",default:'"Nessun risultato"'},{kind:"field",name:"isopen",type:"boolean",description:"toggle combo list opening flag",default:"false"},{kind:"field",name:"isfixed",type:"boolean",description:"fixed style flag",default:"false"},{kind:"field",name:"hascheckall",type:"boolean",description:'show "check all" checkbox (optional)',default:"false"},{kind:"field",name:"checkalltext",type:"string",description:"check all label (optional)",default:'"Seleziona tutti"'},{kind:"field",name:"uncheckalltext",type:"string",description:"uncheck all label (optional)",default:'"Deseleziona tutti"'},{kind:"field",name:"maxcheckableitems",type:"number",description:"max number of checkable items (0 = unlimited)",default:"0"},{kind:"field",name:"hasgroupitems",type:"boolean",description:"group items by category"},{kind:"field",name:"size",type:"any",description:"Available sizes: `big`, `small` and `x-small`. Defaults to `big`.",default:"ControlSize.BIG"}],events:[{kind:"event",name:"comboboxChange",description:"Emitted when value is checked/unchecked. Returns id, items."}]}],exports:[{kind:"js",name:"ZCombobox",declaration:{name:"ZCombobox",module:"src/components/z-combobox/index.tsx"}},{kind:"custom-element-definition",name:"z-combobox",declaration:{name:"ZCombobox",module:"src/components/z-combobox/index.tsx"}}]}]};$({...v()||{},...x,modules:[...(v()||{}).modules||[],...x.modules]});const Y={title:"ZCombobox",component:"z-combobox",argTypes:{items:{control:{type:"object"}},size:{control:{type:"inline-radio"},options:Object.values(l)}},args:{items:[{id:"ite_m_1",name:"First item",checked:!1,category:"Gruppo 1"},{id:"ite_m_2",name:"Second item",checked:!1,category:"Gruppo 1"},{id:"it_em_3",name:"Other item",checked:!1,category:"Gruppo 2"},{id:"it_e_m_5",name:"Last item",checked:!1,category:"Gruppo 3"}],checkalltext:"Select all",disabled:!1,hascheckall:!0,hassearch:!0,inputid:"combo_1",isfixed:!0,isopen:!0,label:"Combobox Label",maxcheckableitems:4,hasgroupitems:!1,noresultslabel:"No items",searchlabel:"Search Label",searchplaceholder:"Search Placeholder",searchtitle:"Search Title",uncheckalltext:"Uncheck All",size:l.BIG},render:e=>E`<z-combobox
      checkalltext=${e.checkalltext}
      disabled=${e.disabled}
      hascheckall=${e.hascheckall}
      hassearch=${e.hassearch}
      inputid=${e.inputid}
      isfixed=${e.isfixed}
      isopen=${e.isopen}
      .items=${e.items}
      label=${e.label}
      maxcheckableitems=${e.maxcheckableitems}
      hasgroupitems=${e.hasgroupitems}
      noresultslabel=${e.noresultslabel}
      searchlabel=${e.searchlabel}
      searchplaceholder=${e.searchplaceholder}
      searchtitle=${e.searchtitle}
      uncheckalltext=${e.uncheckalltext}
      size=${e.size}
    />`},h={},m={args:{hasgroupitems:!0}},p={args:{disabled:!0}};var g,k,y;h.parameters={...h.parameters,docs:{...(g=h.parameters)==null?void 0:g.docs,source:{originalSource:"{}",...(y=(k=h.parameters)==null?void 0:k.docs)==null?void 0:y.source}}};var C,z,I;m.parameters={...m.parameters,docs:{...(C=m.parameters)==null?void 0:C.docs,source:{originalSource:`{
  args: {
    hasgroupitems: true
  }
} satisfies Story`,...(I=(z=m.parameters)==null?void 0:z.docs)==null?void 0:I.source}}};var L,w,S;p.parameters={...p.parameters,docs:{...(L=p.parameters)==null?void 0:L.docs,source:{originalSource:`{
  args: {
    disabled: true
  }
} satisfies Story`,...(S=(w=p.parameters)==null?void 0:w.docs)==null?void 0:S.source}}};const ee=["Default","Groups","Disabled"];export{h as Default,p as Disabled,m as Groups,ee as __namedExportsOrder,Y as default};
