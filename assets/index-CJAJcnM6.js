import"./index-BfGcbr3R.js";import{s as m,g as l}from"./chunk-L4EGOTBX-lo-pZyle.js";import"./entry-preview-Cx7Tr7Nx.js";import{d as u,H as f,c as r,h as n,a as b}from"./index-BZ0rSFNp.js";import{K as a}from"./index-BBy8evlc.js";import{c as p}from"./utils-D8xbZiRf.js";const g=':host,::slotted(*),*{box-sizing:border-box;outline:none}:host{position:relative;display:inline-flex;height:fit-content;flex-direction:column}::slotted(a){text-decoration:none}::slotted(*){color:var(--color-default-text);font-family:var(--font-family-sans);font-weight:var(--font-rg)}.menu-label{position:relative;display:flex;width:100%;align-items:center;padding:0;border:0;border-bottom:var(--border-size-large) solid transparent;margin:0;background:transparent;border-radius:0;color:inherit;text-align:left}button.menu-label{cursor:pointer}.menu-label:focus-visible,div.menu-label:focus-within{box-shadow:var(--shadow-focus-primary)}:host(:is([active],[open])) .menu-label ::slotted(*),.menu-label:focus-visible ::slotted(*),div.menu-label:focus-within ::slotted(*){color:var(--color-primary01);font-weight:var(--font-bd)}:host([vertical-context]) .menu-label{padding:var(--space-unit) 0;border-width:var(--border-size-small);border-color:var(--color-surface03)}:host(:is([active],[open])) .menu-label,.menu-label:hover,.menu-label:focus-visible,div.menu-label:focus-within{border-color:var(--color-primary01)}:host([vertical-context]:is([active],[open])) .menu-label::after,:host([vertical-context]) .menu-label:hover::after,:host([vertical-context]) .menu-label:focus-visible::after,:host([vertical-context]) div.menu-label:focus-within::after{position:absolute;bottom:calc(var(--border-size-small) * -1);left:0;width:100%;height:var(--border-size-large);background-color:var(--color-primary01);content:""}:host([vertical-context]) .menu-label ::slotted(*){padding:0}.menu-label ::slotted(*){display:inline-flex;width:100%;min-width:fit-content;padding-bottom:2px;margin:0;appearance:none;color:var(--z-menu-label-color, var(--color-default-text));font-family:var(--font-family-sans);font-size:var(--font-size-3);font-weight:inherit;line-height:1.5;white-space:nowrap}.menu-label z-icon{margin-left:calc(var(--space-unit) * 1.5);fill:var(--color-default-icon)}::slotted([data-text]:not([slot]))::after{height:0;content:attr(data-text);content:attr(data-text) / "";font-weight:var(--font-bd);letter-spacing:normal;pointer-events:none;user-select:none;visibility:hidden}@media speech{::slotted([data-text]:not([slot]))::after{display:none}}::slotted([data-text]:not([slot])){display:inline-flex;flex-direction:column}.content{background:var(--color-surface01)}:host(:not([open])) .content{display:none}:host([floating]:not([vertical-context])) .content{position:absolute;top:100%;left:0;width:375px;min-width:100%;max-width:100vw;padding:0 calc(var(--space-unit) * 2);box-shadow:var(--shadow-2)}:host(:not([floating])) .content{width:100%}.header{display:flex;align-items:center;padding:var(--space-unit) 0 calc(var(--space-unit) * 2)}.header ::slotted(img[slot="header"]){width:calc(var(--space-unit) * 11.25);height:auto;object-fit:contain}.header ::slotted([slot="header"]:not(:first-child)){margin:auto 0;margin-left:calc(var(--space-unit) * 2.5);font-size:var(--font-size-3);font-weight:var(--font-sb);line-height:1.5}.items{display:flex;flex-direction:column;align-items:flex-start;background:inherit}.items>::slotted([slot="item"]){width:100%;margin:0;font-size:var(--font-size-3);line-height:1.5}.items>::slotted([slot="item"]:focus:focus-visible){box-shadow:var(--shadow-focus-primary)}.items>::slotted([slot="item"]:not(z-menu-section)){padding:var(--space-unit) 0;border-bottom:var(--border-size-small) solid var(--color-surface03)}:host(:not([vertical-context])) .items>::slotted([slot="item"]:last-child){border-bottom:0}.items>::slotted([slot="item"]:hover),.items>::slotted([slot="item"]:focus:focus-visible),.items>::slotted([slot="item"]:active),.items>::slotted([slot="item"][active]),.items>::slotted([slot="item"][data-active]){border-color:var(--color-primary01);font-weight:var(--font-bd)}',o=t=>(t==null?void 0:t.tagName)==="Z-MENU-SECTION",v=class extends f{get focusableItem(){return this.items.find(t=>o(t)?t.htmlTabindex===0:t.tabIndex===0)}toggle(){this.hasContent&&(this.open=!this.open)}onLabelSlotChange(t){const e=t.target.assignedElements()[0];e.dataset.text=e==null?void 0:e.textContent,this.setLabelA11yAttrs()}reflow(t=!1){if(this.floating){if(this.content&&this.hasContent){const{style:e}=this.content,{left:s}=this.host.getBoundingClientRect(),i=getComputedStyle(this.content).width,c=i?parseFloat(i.replace("px","")):375,d=30;e.left=`${Math.min(window.innerWidth-s-c-d,0)}px`}t&&(this.raf=requestAnimationFrame(this.reflow.bind(this,t)))}}checkContent(){this.hasHeader=!!this.host.querySelectorAll("[slot=header]").length,this.hasContent=!!this.host.querySelectorAll("[slot=item]").length||this.hasHeader}setItemTabindex(t,e){o(t)?t.htmlTabindex=e:t.tabIndex=e}setItemsA11yAttrs(){this.items.forEach((t,e)=>{const s=e===0?0:-1;this.setItemTabindex(t,s),o(t)||t.setAttribute("role","menuitem")})}onItemsChange(){this.checkContent(),this.items=Array.from(this.host.children).filter(({slot:t})=>t==="item"),this.setItemsA11yAttrs(),this.items.forEach(t=>{o(t)||(t.dataset.text=t.textContent)})}moveFocus(t,e){o(t)?t.setFocus():(t.tabIndex=0,setTimeout(()=>{t.focus()},100)),e&&this.setItemTabindex(e,-1)}onLabelClick(){this.toggle(),this.setFocus()}onLabelKeydown(t){if(t.key===a.ENTER||t.key===a.SPACE){t.preventDefault(),t.stopPropagation(),this.toggle(),this.open&&this.moveFocus(this.items[0]);return}this.verticalContext&&t.key===a.ARROW_RIGHT&&!this.open&&(t.preventDefault(),t.stopPropagation(),this.open=!0,this.moveFocus(this.items[0]))}async setFocus(){this.htmlTabindex=0,(this.hasContent?this.labelButton:this.host.firstElementChild).focus()}async focusLastItem(){const t=this.items[this.items.length-1];if(o(t)&&t.open){t.focusLastItem();return}this.moveFocus(t)}onOpenChanged(){if(!this.open){cancelAnimationFrame(this.raf),this.closed.emit(),this.items.forEach(t=>{o(t)&&t.open&&(t.open=!1)});return}this.setItemsA11yAttrs(),this.opened.emit(),this.floating&&this.reflow(!0)}setLabelA11yAttrs(){if(this.hasContent&&this.labelButton){this.labelButton.tabIndex=this.htmlTabindex;return}const t=this.host.firstElementChild;t.role="menuitem",t.tabIndex=this.htmlTabindex}onItemClick(t){const e=this.items.find(s=>p(s,t.target));e&&this.items.forEach(s=>{s!==e&&(o(s)?s.htmlTabindex=-1:s.tabIndex=-1)})}onKeyDown(t){var e;if(this.hasContent)switch(t.key){case a.ESC:if(!this.open)break;t.stopPropagation(),t.preventDefault(),this.open=!1,this.setFocus();break;case a.ARROW_DOWN:{if(document.activeElement===this.host){if(this.verticalContext&&!this.open)break;t.stopPropagation(),t.preventDefault(),this.open||(this.open=!0),this.moveFocus(this.items[0]);break}const s=this.items.indexOf(this.focusableItem);if(this.verticalContext&&s===this.items.length-1){this.setItemTabindex(this.items[s],-1),this.htmlTabindex=0;break}t.stopPropagation(),t.preventDefault();const i=this.items[s+1];this.moveFocus(i??this.items[0],this.focusableItem);break}case a.ARROW_UP:{if(document.activeElement===this.host){if(this.verticalContext)break;t.stopPropagation(),t.preventDefault(),this.open||(this.open=!0),this.moveFocus(this.items[this.items.length-1],this.focusableItem);break}t.stopPropagation(),t.preventDefault();const s=this.items.indexOf(this.focusableItem);if(s===0&&this.verticalContext){this.setItemTabindex(this.focusableItem,-1),this.setFocus();break}const i=(e=this.items[s-1])!==null&&e!==void 0?e:this.items[this.items.length-1];if(o(i)&&i.open){this.setItemTabindex(this.focusableItem,-1),i.focusLastItem();break}this.moveFocus(i,this.focusableItem);break}case a.ARROW_LEFT:if(!this.open||!this.verticalContext)break;t.preventDefault(),t.stopPropagation(),this.open=!1,this.setFocus()}}constructor(){super(),this.__registerHost(),this.__attachShadow(),this.opened=r(this,"opened",7),this.closed=r(this,"closed",7),this.floating=!0,this.open=!1,this.verticalContext=!1,this.htmlTabindex=-1,this.items=[],this.toggle=this.toggle.bind(this),this.checkContent=this.checkContent.bind(this),this.onLabelSlotChange=this.onLabelSlotChange.bind(this),this.onLabelClick=this.onLabelClick.bind(this),this.onItemsChange=this.onItemsChange.bind(this),this.onLabelKeydown=this.onLabelKeydown.bind(this)}componentWillLoad(){this.setLabelA11yAttrs(),this.onItemsChange()}render(){return this.hasContent?n(b,null,n("button",{ref:t=>this.labelButton=t,class:"menu-label","aria-expanded":`${!!this.open}`,"aria-haspopup":`${this.hasContent}`,"aria-label":this.open?"Chiudi menù":"Apri menù",role:"menuitem",tabIndex:this.htmlTabindex,onClick:this.onLabelClick,onKeyDown:this.onLabelKeydown},n("slot",{onSlotchange:this.onLabelSlotChange}),n("z-icon",{name:this.open?"chevron-up":"chevron-down"})),n("div",{class:"content",ref:t=>this.content=t},this.hasHeader&&n("header",{class:"header"},n("slot",{name:"header",onSlotchange:this.checkContent})),n("div",{class:"items",role:"menu"},n("slot",{name:"item",onSlotchange:this.onItemsChange})))):n("div",{class:"menu-label"},n("slot",{onSlotchange:this.onLabelSlotChange}))}get host(){return this}static get watchers(){return{open:["onOpenChanged"],htmlTabindex:["setLabelA11yAttrs"]}}static get style(){return g}};u(v,[1,"z-menu",{active:[516],floating:[516],open:[1540],verticalContext:[516,"vertical-context"],htmlTabindex:[2,"html-tabindex"],hasHeader:[32],hasContent:[32],setFocus:[64],focusLastItem:[64]},[[4,"click","onItemClick"],[0,"keydown","onKeyDown"]],{open:["onOpenChanged"],htmlTabindex:["setLabelA11yAttrs"]}]);const h={schemaVersion:"1.0.0",modules:[{kind:"javascript-module",path:"",declarations:[{kind:"class",name:"ZMenu",tagName:"z-menu",customElement:!0,members:[{kind:"field",name:"active",type:"boolean",description:"Flag to set the active status of the menu."},{kind:"field",name:"floating",type:"boolean",description:`Flag to set the display mode of the list.
If true, the list will be absolutely positioned under the menu label,
stacked beneath it otherwise.`,default:"true"},{kind:"field",name:"open",type:"boolean",description:"The opening state of the menu.",default:"false"},{kind:"field",name:"verticalContext",type:"boolean",description:"Tells the component that it's placed in a vertical context with other `ZMenu`s (usually in the ZAppHeader's offcanvas).\nA small border is placed under it as a separator from other elements.",default:"false"},{kind:"field",name:"htmlTabindex",type:"number",description:`Tabindex value to set on the menu label.
Useful to manage keyboard navigation focus with roving tabindex handled by this component's parent (usually ZAppHeader).`,default:"-1"}],events:[{kind:"event",name:"opened",description:"The menu has been opened."},{kind:"event",name:"closed",description:"The menu has been closed."}],cssProperties:[{name:"--z-menu-label-color",description:"Color of the label's text."}],slots:[{name:"-",description:"Menu label"},{name:"header",description:"Header to display as the first entry of the open menu."},{name:"item",description:"Single entry of the section. Can be slotted multiple times to insert items onto the menu. Set the `data-active` HTML attribute on the element to highlight it (`active` also works but `data-active` is preferable). Use `z-menu-section` for submenus."}]}],exports:[{kind:"js",name:"ZMenu",declaration:{name:"ZMenu",module:"src/components/z-menu/index.tsx"}},{kind:"custom-element-definition",name:"z-menu",declaration:{name:"ZMenu",module:"src/components/z-menu/index.tsx"}}]}]};m({...l()||{},...h,modules:[...(l()||{}).modules||[],...h.modules]});
