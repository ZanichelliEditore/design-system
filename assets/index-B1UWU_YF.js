import{s as x,g as E}from"./chunk-L4EGOTBX-lo-pZyle.js";import"./entry-preview-Cx7Tr7Nx.js";import{d as v,H as _,c as w,h as y,a as H}from"./index-BZ0rSFNp.js";import{P as o,K as k,e as R}from"./index-BBy8evlc.js";import{c as B,a as g,f as C,g as M,i as I}from"./utils-CXsQRbEU.js";const F=':host{position:fixed;display:none;max-width:calc(100% - var(--grid-margin) * 2);max-height:calc(100% - var(--grid-margin) * 2);padding:var(--z-popover-padding, 0);background:var(--z-popover-theme--surface, var(--color-surface01));border-radius:var(--border-radius-small);color:var(--z-popover-theme--text, var(--color-default-text));fill:currentcolor;filter:var(--z-popover-shadow-filter, drop-shadow(0 1px 2px var(--shadow-color-base)));text-align:center;visibility:hidden;}:host([open]:not([open="false"])[current-position]){display:block}:host([center][current-position="top"]),:host([center][current-position="bottom"]){transform:translateX(-50%)}:host([center][current-position="right"]),:host([center][current-position="left"]){transform:translateY(-50%)}:host([current-position])::before{--arrow-size:6px;--arrow-edge-offset:calc(100% - var(--space-unit) - (var(--arrow-size) / 2));--arrow-center-x-offset:calc(50% - (var(--arrow-size) / 2));--arrow-center-y-offset:calc(100% - (var(--arrow-size) / 2));position:absolute;display:block;width:var(--arrow-size);height:var(--arrow-size);background:var(--z-popover-theme--surface, var(--color-surface01));content:"";transform:rotate(45deg)}:host([show-arrow="false"])::before,:host(:not([show-arrow]))::before{display:none}:host([current-position^="top"])::before{top:var(--arrow-center-y-offset)}:host([current-position^="bottom"])::before{bottom:var(--arrow-center-y-offset)}:host([current-position="top"])::before,:host([current-position="bottom"])::before{right:var(--arrow-edge-offset)}:host([current-position="right"])::before,:host([current-position="left"])::before{bottom:var(--arrow-edge-offset)}:host([current-position="right"])::before{right:var(--arrow-center-y-offset)}:host([current-position="left"])::before{left:var(--arrow-center-y-offset)}:host([current-position="top_right"])::before,:host([current-position="bottom_right"])::before{right:var(--arrow-edge-offset)}:host([current-position="top_left"])::before,:host([current-position="bottom_left"])::before{left:var(--arrow-edge-offset)}:host([current-position="right_top"])::before,:host([current-position="left_top"])::before{top:var(--arrow-edge-offset)}:host([current-position="right_top"])::before,:host([current-position="right_bottom"])::before{right:var(--arrow-center-y-offset)}:host([current-position="left_top"])::before,:host([current-position="left_bottom"])::before{left:var(--arrow-center-y-offset)}:host([current-position="right_bottom"])::before,:host([current-position="left_bottom"])::before{bottom:var(--arrow-edge-offset)}:host([center][current-position="top"])::before,:host([center][current-position="bottom"])::before{right:auto;left:var(--arrow-center-x-offset)}:host([center][current-position="right"])::before,:host([center][current-position="left"])::before{top:var(--arrow-center-x-offset);bottom:auto}',b=class extends _{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.positionChange=w(this,"positionChange",7),this.openChange=w(this,"openChange",7),this.position=o.TOP,this.open=!1,this.showArrow=!1,this.center=!1,this.closable=!0,this.spaceTolerance=3}closePopoverWithKeyboard(e){this.closable&&e.key===k.ESC&&(this.open=!1)}handleOutsideClick(e){const t=e.target;!this.closable||!this.open||B(this.host,t)||(B(this.boundElement,t)&&e.stopPropagation(),this.open=!1)}validatePosition(e){(!Object.values(o).includes(e)||e===o.AUTO)&&(e=o.TOP,this.position=e),this.currentPosition=e,this.open&&this.setPosition()}onOpen(){if(cancelAnimationFrame(this.animationFrameRequestId),this.openChange.emit({open:this.open}),!this.open){Object.assign(this.host.style,{top:"auto",right:"auto",bottom:"auto",left:"auto",maxWidth:"",maxHeight:"",visibility:"hidden"}),this.currentPosition=void 0;return}const e=()=>{this.open&&(this.setPosition(),this.animationFrameRequestId=requestAnimationFrame(e))};setTimeout(()=>{e()},0)}onBindingChange(){this.findBoundElement()}get offsetModifier(){return this.center?.5:0}findBoundElement(){typeof this.bindTo=="string"?this.boundElement=this.host.ownerDocument.querySelector(this.bindTo):this.bindTo?this.boundElement=this.bindTo:(this.boundElement=g(this.host),this.boundElement.tagName.toLowerCase()==="z-tooltip"&&(this.boundElement=g(this.boundElement)))}hasCenteredHorizontalSpace(e,t,i,n){const r=(i-n)*(1-this.offsetModifier);return this.center?t>=r-this.spaceTolerance&&e>=r-this.spaceTolerance:t>=r-this.spaceTolerance}hasCenteredVerticalSpace(e,t,i,n){const r=(i-n)*(1-this.offsetModifier);return this.center?e>=r-this.spaceTolerance&&t>=r-this.spaceTolerance:t>=r-this.spaceTolerance}hasEnoughSideSpace(e,t,i,n){return e>=t-i*(1-n)-this.spaceTolerance}getOptimalPopoverPosition(e,t){const i=this.host.offsetWidth,n=this.host.offsetHeight,r=this.boundElement.getBoundingClientRect().width,h=this.boundElement.getBoundingClientRect().height,s=this.offsetModifier,c=f=>{switch(f){case o.TOP:return t.top>=n-this.spaceTolerance&&this.hasCenteredHorizontalSpace(t.left,t.right,i,r);case o.TOP_RIGHT:return t.top>=n&&this.hasEnoughSideSpace(t.right,i,r,s);case o.TOP_LEFT:return t.top>=n&&this.hasEnoughSideSpace(t.left,i,r,s);case o.RIGHT:return t.right>=i&&this.hasCenteredVerticalSpace(t.top,t.bottom,n,h);case o.RIGHT_BOTTOM:return t.right>=i&&this.hasEnoughSideSpace(t.bottom,n,h,s);case o.RIGHT_TOP:return t.right>=i&&this.hasEnoughSideSpace(t.top,n,h,s);case o.BOTTOM:return t.bottom>=n&&this.hasCenteredHorizontalSpace(t.left,t.right,i,r);case o.BOTTOM_LEFT:return t.bottom>=n&&this.hasEnoughSideSpace(t.left,i,r,s);case o.BOTTOM_RIGHT:return t.bottom>=n&&this.hasEnoughSideSpace(t.right,i,r,s);case o.LEFT:return t.left>=i&&this.hasCenteredVerticalSpace(t.top,t.bottom,n,h);case o.LEFT_TOP:return t.left>=i&&this.hasEnoughSideSpace(t.top,n,h,s);case o.LEFT_BOTTOM:return t.left>=i&&this.hasEnoughSideSpace(t.bottom,n,h,s);default:return!1}};if(c(e))return e;const d=b.positionOrder,l=d.indexOf(e);if(l===-1)return e;for(let f=1;f<d.length;f++){const m=(l+f)%d.length,u=d[m];if(c(u))return u}return this.findBestFallbackPosition(t)}findBestFallbackPosition(e){const t=e.right>=e.left?o.RIGHT:o.LEFT,i=e.bottom>=e.top?o.BOTTOM:o.TOP,n=Math.max(e.right,e.left),r=Math.max(e.bottom,e.top),h=r>=n?i:t;let s=!1;if(h===i){const d=Math.min(e.right,e.left);s=n>=d*2}else{const d=Math.min(e.bottom,e.top);s=r>=d*2}return s?`${h}_${h===i?t:i}`:h}findScrollableAncestor(e){let t=g(e);for(;t;){if(t===e.ownerDocument.documentElement)return t;const i=window.getComputedStyle(t),{overflow:n,overflowX:r,overflowY:h}=i,s=n==="hidden"||h==="hidden"||r==="hidden",c=t.scrollHeight>t.clientHeight&&n!=="visible"&&h!=="visible"||t.scrollWidth>t.clientWidth&&n!=="visible"&&r!=="visible";if(!s&&c)return t;t=g(t)}return e.ownerDocument.documentElement}calculateAvailableSpace(){const e=this.boundElement.getBoundingClientRect();if(this.lastBoundRect&&this.lastBoundRect.x===e.x&&this.lastBoundRect.y===e.y&&this.lastBoundRect.width===e.width&&this.lastBoundRect.height===e.height&&this.cachedAvailableSpace)return this.cachedAvailableSpace;this.lastBoundRect=e;const t=this.findScrollableAncestor(this.boundElement),i=t.getBoundingClientRect(),n=t!==this.boundElement.ownerDocument.documentElement,r=this.boundElement.ownerDocument.documentElement.clientWidth,h=this.boundElement.ownerDocument.documentElement.clientHeight,s=8,c=n?i.top:0,d=n?r-i.right:0,l=n?h-i.bottom:0,f=n?i.left:0;return this.cachedAvailableSpace={top:e.top-c-s,right:r-e.right-d-s,bottom:h-e.bottom-l-s,left:e.left-f-s},this.cachedAvailableSpace}getBoundElementOffsets(){const e=this.boundElement.getBoundingClientRect(),t=this.boundElement.ownerDocument.documentElement.clientWidth,i=this.boundElement.ownerDocument.documentElement.clientHeight;return{top:e.top,right:t-e.right,bottom:i-e.bottom,left:e.left}}computePositionOffsets(){const e=this.getBoundElementOffsets(),t=C(this.host);if(t===this.host.ownerDocument.documentElement)return e;const n=t.getBoundingClientRect(),r=getComputedStyle(t),h={top:n.top+parseFloat(r.borderTopWidth),right:n.right-parseFloat(r.borderRightWidth),bottom:n.bottom-parseFloat(r.borderBottomWidth),left:n.left+parseFloat(r.borderLeftWidth)},s=this.boundElement.getBoundingClientRect(),c={top:s.top-h.top,right:h.right-s.right,bottom:h.bottom-s.bottom,left:s.left-h.left};return{top:c.top+t.scrollTop,right:c.right-t.scrollLeft,bottom:c.bottom-t.scrollTop,left:c.left+t.scrollLeft}}applyPositionStyles(e,t){const i=this.boundElement.offsetWidth,n=this.boundElement.offsetHeight,r=this.offsetModifier,h=this.showArrow&&this.center?8:0,s=this.host.style,c=parseInt(s.getPropertyValue("--space-unit"))||8,d=this.computePositionOffsets(),l=d.left+i*r,f=d.right+i*r,m=d.top+n,u=d.bottom+n,T=d.top+n*r,O=d.bottom+n*r;let a,p;switch(e){case o.TOP:case o.TOP_RIGHT:s.bottom=`${u+c}px`,s.left=`${l-(e===o.TOP_RIGHT?h:0)}px`,p=t.top-c,e===o.TOP_RIGHT&&(a=t.right+i*r);break;case o.TOP_LEFT:s.right=`${f-h}px`,s.bottom=`${u+c}px`,a=t.left+i*r,p=t.top-c;break;case o.BOTTOM:case o.BOTTOM_RIGHT:s.top=`${m+c}px`,s.left=`${l-(e===o.BOTTOM_RIGHT?h:0)}px`,p=t.bottom-c,e===o.BOTTOM_RIGHT&&(a=t.right+i*r);break;case o.BOTTOM_LEFT:s.top=`${m+c}px`,s.right=`${f-h}px`,a=t.left+i*r,p=t.bottom-c;break;case o.RIGHT:case o.RIGHT_BOTTOM:s.top=`${T-(e===o.RIGHT_BOTTOM?h:0)}px`,s.left=`${d.left+i+c}px`,a=t.right-c,e===o.RIGHT?p=t.top+t.bottom+n:p=t.bottom+n*r;break;case o.RIGHT_TOP:s.bottom=`${O-h}px`,s.left=`${d.left+i+c}px`,a=t.right-c,p=t.top+n*r;break;case o.LEFT:case o.LEFT_BOTTOM:s.top=`${T-(e===o.LEFT_BOTTOM?h:0)}px`,s.right=`${d.right+i+c}px`,a=t.left-c,e===o.LEFT_BOTTOM&&(p=t.bottom+n*r);break;case o.LEFT_TOP:s.right=`${d.right+i+c}px`,s.bottom=`${O-h}px`,a=t.left-c,p=t.top+n*r;break}M()!==R.MOBILE&&Object.assign(s,{maxWidth:a?`${a}px`:"",maxHeight:p?`${p}px`:""})}setPosition(){if(!this.boundElement)return;if(!I(this.boundElement,this.findScrollableAncestor(this.boundElement))){this.open=!1;return}Object.assign(this.host.style,{top:"auto",right:"auto",bottom:"auto",left:"auto",maxWidth:"",maxHeight:"",visibility:"hidden"});const e=this.calculateAvailableSpace(),t=this.getOptimalPopoverPosition(this.position,e);this.applyPositionStyles(t,e),this.currentPosition=t,this.positionChange.emit({position:this.currentPosition}),this.host.style.visibility="visible"}componentWillLoad(){this.validatePosition(this.position)}componentDidLoad(){this.findBoundElement(),this.open&&this.onOpen()}disconnectedCallback(){cancelAnimationFrame(this.animationFrameRequestId)}render(){return y(H,{key:"2d61240eabc1a0fa8dfee69b380bf344851bc425","current-position":this.currentPosition},y("slot",{key:"9003d99c07267875e9e96fc35cebc568e325f993"}))}get host(){return this}static get watchers(){return{position:["validatePosition"],open:["onOpen"],bindTo:["onBindingChange"]}}static get style(){return F}};b.positionOrder=[o.TOP,o.TOP_RIGHT,o.TOP_LEFT,o.RIGHT,o.RIGHT_BOTTOM,o.RIGHT_TOP,o.BOTTOM,o.BOTTOM_LEFT,o.BOTTOM_RIGHT,o.LEFT,o.LEFT_TOP,o.LEFT_BOTTOM];v(b,[1,"z-popover",{position:[1544],open:[1540],bindTo:[8,"bind-to"],showArrow:[516,"show-arrow"],center:[516],closable:[4],currentPosition:[32]},[[8,"keyup","closePopoverWithKeyboard"],[18,"click","handleOutsideClick"]],{position:["validatePosition"],open:["onOpen"],bindTo:["onBindingChange"]}]);const P={schemaVersion:"1.0.0",modules:[{kind:"javascript-module",path:"",declarations:[{kind:"class",name:"ZPopover",tagName:"z-popover",customElement:!0,members:[{kind:"field",name:"position",type:"any",description:"The preferred position to render the popover.\nThe popover will automatically search another position if not enough space is available for the preferred position.\nIf the preferred position is not available, it will try to find the best position starting from `TOP` and going clockwise.",default:"PopoverPosition.TOP"},{kind:"field",name:"open",type:"boolean",description:"The initial open state of the popover.\nInternal changes of this prop are emitted through the `openChange` event.\nMake sure to listen to that event if you need the updated state of the popover from the outside, to avoid inconsistent values.",default:"false"},{kind:"field",name:"bindTo",type:"any",description:`The selector or the element bound with the popover.
If string css selector is provided make sure to use a valid selector.`},{kind:"field",name:"showArrow",type:"boolean",description:"Whether to show popover's arrow.",default:"false"},{kind:"field",name:"center",type:"boolean",description:'Whether to center the popup on the main side (according to "position").',default:"false"},{kind:"field",name:"closable",type:"boolean",description:"If true, the popover can be closed by clicking outside of it or pressing the escape key.\nOtherwise, it will be closed only programmatically (by setting `open` to `false`).",default:"true"}],events:[{kind:"event",name:"positionChange",description:"Fired when the position changes."},{kind:"event",name:"openChange",description:"Open change event."}],cssProperties:[{name:"--z-popover-theme--surface",description:"background color of the popover."},{name:"--z-popover-theme--text",description:"foreground color of the popover."},{name:"--z-popover-padding",description:"padding of the popover."},{name:"--z-popover-shadow-filter",description:"drop-shadow filter of the popover. Defaults to `drop-shadow(0 1px 2px var(--shadow-color-base))`."}]}],exports:[{kind:"js",name:"ZPopover",declaration:{name:"ZPopover",module:"src/components/z-popover/index.tsx"}},{kind:"custom-element-definition",name:"z-popover",declaration:{name:"ZPopover",module:"src/components/z-popover/index.tsx"}}]}]};x({...E()||{},...P,modules:[...(E()||{}).modules||[],...P.modules]});
