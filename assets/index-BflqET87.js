import"./index-voqz3CUY.js";import"./index-C1pdL_Kg.js";import"./index-8Bqs44tk.js";import"./index-DgL01iRG.js";import"./index-D43lbI9l.js";import"./index-BSoUoz93.js";import"./index-Cg_wPSWv.js";import{s as w,g as p}from"./chunk-L4EGOTBX-lo-pZyle.js";import"./entry-preview-Cx7Tr7Nx.js";import{d as S,H as x,c as h,h as i,a as k}from"./index-BZ0rSFNp.js";import{C as I,B as R,d as f,L as u,K as o}from"./index-C38_VAhp.js";import{r as C,g,h as d}from"./utils-BhVYCk1q.js";const L=':host{--z-searchbar-tag-text-color:var(--color-primary03);--z-searchbar-tag-bg:var(--color-hover-primary);--z-searchbar-item-height:44px;z-index:15;display:flex;column-gap:calc(var(--space-unit) * 2);font-family:var(--font-family-sans);font-weight:var(--font-rg)}:host,*{box-sizing:border-box}:host::part(list-item-container){display:block;min-height:unset;padding:0}.input-container{position:relative;display:flex;width:100%;flex-direction:column}.results-wrapper{position:absolute;top:calc(100% - 1px);left:0;width:100%;padding:calc(var(--space-unit) / 4);border:var(--border-size-small) solid var(--color-surface03);border-top:none;background:var(--color-surface01)}.results{overflow:auto;max-height:var(--z-searchbar-results-height, 540px);padding:calc(var(--space-unit) / 2) calc(var(--space-unit) * 1.5)}.results::-webkit-scrollbar{width:6px;background:linear-gradient(to right, transparent 0 1px, var(--gray200) 1px 5px, transparent 5px 6px)}.results::-webkit-scrollbar-thumb{background-color:var(--color-primary01)}.results::-webkit-scrollbar-thumb:hover{background-color:var(--color-hover-primary)}@supports not selector(.results::-webkit-scrollbar-track){.results{scrollbar-color:var(--color-primary01) transparent}}.results .category-heading{display:block;font-size:var(--font-size-2);font-weight:var(--font-rg);line-height:var(--font-size-3)}.results .category-heading>*{display:block}.results .category-heading>.category{color:var(--color-text05);font-style:italic}.results .category-heading>.subcategory{margin-top:var(--space-unit);color:var(--color-default-text);text-transform:uppercase}.results z-list-element{position:relative;display:block}z-list-element>.item-search{padding:var(--space-unit) 0}z-list z-list-element::before{position:absolute;z-index:100;top:5px;left:-20px;width:8px;height:1em;border-bottom:1px solid var(--color-disabled01-icon);border-left:1px solid var(--color-disabled01-icon);content:"";cursor:pointer}z-list z-list-element::after{position:absolute;z-index:100;top:5px;left:-20px;width:8px;height:100%;border-left:1px solid var(--color-disabled01-icon);content:"";cursor:pointer}z-list z-list-element:last-child::after{display:none}z-list>z-list-element::before,z-list>z-list-element::after,z-list>z-list-group>z-list-element::before,z-list>z-list-group>z-list-element::after{display:none}z-list>div.children-node{padding-left:calc(var(--space-unit) * 3)}.results z-list-element>.list-element{display:flex;justify-content:space-between;padding:calc(var(--space-unit) * 1.25) 0;cursor:pointer}.results z-list-element>.list-element:focus-visible{box-shadow:var(--shadow-focus-primary);outline:none}.results z-list-element>.list-element .item.ellipsis{overflow:hidden}.results z-list-element .list-element::after{position:absolute;top:0;right:0;display:block;width:100%;height:44px;content:"";transform:translateX(-100%)}.results z-list-element .list-element.focused.hovered::after{padding-left:6px}.results z-list-element>.list-element:hover,.results z-list-element>.list-element:hover::after{background-color:var(--color-background);cursor:pointer}.results z-list-element>.list-element>z-tag{border:1px solid var(--gray800);font-size:var(--font-size-1);font-weight:var(--font-sb);--z-tag-bg:var(--z-searchbar-tag-bg);--z-tag-text-color:var(--z-searchbar-tag-text-color)}.results .item{--z-icon-height:12px;--z-icon-width:12px;display:flex;flex-flow:row nowrap;align-items:center;justify-content:flex-start;color:var(--color-default-text);column-gap:calc(var(--space-unit) * 1.5);fill:var(--color-default-icon);font-size:var(--font-size-2);line-height:var(--font-size-6)}.results .item.ellipsis>.item-label{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.results .item>.item-label mark{background:var(--color-primary03)}.results .item.item-search{--z-icon-height:16px;--z-icon-width:16px}.results .item-show-all{text-align:center}.results .item-no-results{display:block;font-size:var(--font-size-2);font-style:italic;line-height:var(--font-size-5)}.results .item-no-results>ul{padding-left:calc(var(--space-unit) * 2);margin:var(--space-unit)}@media (min-width: 768px){.results .category-heading{font-size:var(--font-size-3);line-height:var(--font-size-6)}.results .item{font-size:var(--font-size-3);line-height:var(--font-size-6)}.results .item.item-search{--z-icon-height:18px;--z-icon-width:18px}.results .item.ellipsis>.item-label{height:24px}.results z-list-element>.list-element>z-tag{min-width:max-content}}@media (min-width: 1152px){.results .item{cursor:pointer}.results .item-no-results{cursor:default;font-size:var(--font-size-3);line-height:var(--font-size-6)}}:host([size="small"]) .results :is(.item,.category-heading),:host([size="x-small"]) .results :is(.item,.category-heading){font-size:var(--font-size-2)}:host([size="small"]) .results .item:not(.has-category),:host([size="x-small"]) .results .item:not(.has-category){--z-icon-height:16px;--z-icon-width:16px}:host([size="small"]) z-list-element>.list-element,:host([size="small"]) z-list-element>.item-search{padding:calc(var(--space-unit) * 0.75) 0}:host([size="x-small"]) z-list-element>.list-element,:host([size="x-small"]) z-list-element>.item-search{padding:calc(var(--space-unit) / 2) 0}:host([size="small"]) z-list-element .list-element::after{height:36px}:host([size="x-small"]) z-list-element .list-element::after{height:32px}',E=class extends x{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.searchSubmit=h(this,"searchSubmit",7),this.searchTyping=h(this,"searchTyping",7),this.searchItemClick=h(this,"searchItemClick",7),this.resultsItemsList=null,this.items=[],this.htmlid=`searchbar-${C()}`,this.preventSubmit=!1,this.value=void 0,this.placeholder=void 0,this.autocomplete=!1,this.autocompleteMinChars=3,this.resultsCount=void 0,this.searchHelperLabel="Cerca {searchString}",this.resultsItems=void 0,this.sortResultsItems=!1,this.showSearchButton=!1,this.searchButtonIconOnly=!1,this.size=I.BIG,this.variant=R.PRIMARY,this.searchString=this.value,this.currResultsCount=0,this.showResults=!1,this.isMobile=!1,this.selectedItem=void 0}emitSearchSubmit(){this.searchSubmit.emit(this.inputRef.value)}emitSearchTyping(e){this.searchTyping.emit(e)}emitSearchItemClick(e){this.searchItemClick.emit(e),this.selectedItem=e,this.searchString=""}watchItems(){this.resultsItemsList=this.getResultsItemsList()}watchResultsCount(){this.currResultsCount=this.resultsCount}watchValue(){this.searchString=this.value}watchSearchString(){this.emitSearchTyping(this.searchString),this.items=[],this.searchString||(this.currResultsCount=this.resultsCount)}watchShowResults(){this.showResults||(this.items=[])}disconnectedCallback(){var e;(e=this.resizeObserver)===null||e===void 0||e.disconnect()}componentDidLoad(){this.resizeObserver=new ResizeObserver(()=>{g()===f.MOBILE&&!this.isMobile&&(this.isMobile=!0),g()!==f.MOBILE&&this.isMobile&&(this.isMobile=!1)}),this.resizeObserver.observe(this.element)}componentWillLoad(){this.resultsItemsList=this.getResultsItemsList(),this.currResultsCount=this.resultsCount}getResultsItemsList(){return typeof this.resultsItems=="string"?JSON.parse(this.resultsItems):this.resultsItems}getGroupedItems(e){const t={};return e.forEach(l=>{var s;const r=`${l==null?void 0:l.category}${l==null?void 0:l.subcategory}`;t[r]=(s=t[r])!==null&&s!==void 0?s:{category:l==null?void 0:l.category,subcategory:l==null?void 0:l.subcategory,items:[]},t[r].items.push(l)}),this.sortResultsItems?Object.keys(t).sort().reduce((l,s)=>(l[s]=Object.assign(Object.assign({},t[s]),{items:t[s].items.sort((r,c)=>{const n=r.label.toUpperCase(),a=c.label.toUpperCase();return n<a?-1:n>a?1:0})}),l),{}):t}checkResultsCount(e){return!this.currResultsCount||e<this.currResultsCount}handleStopTyping(e){e.stopPropagation(),this.searchString=e.detail.value,this.selectedItem&&(this.selectedItem=void 0)}handleSubmit(){this.preventSubmit||this.emitSearchSubmit()}handleOutsideClick(e){const t=e.composedPath(),l=t.find(s=>s.nodeName==="Z-SEARCHBAR");if(!l||l.htmlid!==this.htmlid){this.showResults=!1;return}if(t.find(s=>{var r;return(s==null?void 0:s.nodeName)==="Z-INPUT"||((r=s==null?void 0:s.classList)===null||r===void 0?void 0:r.contains("results"))})){this.showResults=!0;return}this.showResults=!1}renderInput(){var e;return i("z-input",{ref:t=>{this.inputRef=t},htmlid:`input-${this.htmlid}`,message:!1,placeholder:this.placeholder,onStopTyping:t=>this.handleStopTyping(t),onKeyUp:t=>{d(t,()=>this.handleSubmit()),this.handleArrowsNavigation(t)},value:this.searchString||((e=this.selectedItem)===null||e===void 0?void 0:e.label),ariaLabel:this.placeholder,size:this.size})}renderButton(){if(!this.showSearchButton)return null;const e=this.searchButtonIconOnly?{icon:"search"}:null,t=this.searchButtonIconOnly?"":"CERCA",l=this.searchButtonIconOnly?{"aria-label":"CERCA"}:null,s=Object.assign(Object.assign({disabled:this.preventSubmit,variant:this.variant,size:this.size,onClick:()=>this.handleSubmit()},e),l);return i("z-button",Object.assign({},s),t)}renderResults(){return!this.showResults||!this.autocomplete||!this.searchString||this.searchString.length<this.autocompleteMinChars||!this.resultsItemsList?null:i("div",{class:"results-wrapper"},i("div",{class:"results"},this.renderResultsList()))}renderResultsList(){var e,t;return this.preventSubmit&&!(!((e=this.resultsItemsList)===null||e===void 0)&&e.length)?i("span",{class:"item item-no-results"},"Non abbiamo trovato risultati per ",i("b",null,this.searchString),i("br",null),i("br",null),"Cosa puoi fare?",i("ul",null,i("li",null,"Verificare di aver scritto bene"),i("li",null,"Provare a cercare un'altra parola"),i("li",null,"Provare a cercare qualcosa di più generico"))):i("z-list",{role:"listbox",id:`list-${this.htmlid}`},this.renderSearchHelper(!!(!((t=this.resultsItemsList)===null||t===void 0)&&t.length)),this.renderItems(),this.renderShowAllResults())}renderItems(){var e;if(!(!((e=this.resultsItemsList)===null||e===void 0)&&e.length))return[];const t=this.getGroupedItems(this.resultsItemsList),l=[];let s=0;return Object.values(t).forEach((r,c,n)=>{if(this.checkResultsCount(s)){const a=[];r.items.forEach((b,m,z)=>{if(this.checkResultsCount(s)){const y=c===n.length-1&&m===z.length-1;a.push(this.renderItem(b,m,!y))}s++}),a.length&&l.push(i("z-list-group",{"divider-type":u.ELEMENT},this.renderItemCategory(r),a))}}),l}handleArrowsNavigation(e){const t=e.target;if(![o.ARROW_DOWN,o.ARROW_UP].includes(e.key)){e.preventDefault();return}if(!this.items.length){const r=this.element.shadowRoot.querySelector("z-list");if(!r)return;this.items=Array.from(r.querySelectorAll(".list-element"))}this.items.forEach(r=>r.classList.contains("focused")&&r.classList.remove("focused"));const s=this.items.indexOf(t);if(e.key===o.ARROW_DOWN){e.preventDefault();const r=s+1;r<this.items.length&&(this.items[r].focus(),this.items[r].classList.add("focused"))}if(e.key===o.ARROW_UP){e.preventDefault();const r=s-1;r<0&&(this.element.shadowRoot.querySelector("input").focus(),this.element.shadowRoot.querySelector("input").setSelectionRange(this.inputRef.value.length,this.inputRef.value.length)),r>=0&&(this.items[r].focus(),this.items[r].classList.add("focused"))}}renderItem(e,t,l){return i("z-list-element",{id:`list-item-${this.htmlid}-${t}`,tabIndex:0,role:"option",dividerType:l?u.ELEMENT:void 0,onKeyDown:s=>this.handleArrowsNavigation(s)},i("div",{class:"list-element",tabIndex:0,onClick:()=>this.emitSearchItemClick(e),onKeyDown:s=>d(s,()=>this.emitSearchItemClick(e)),onMouseEnter:s=>{s.target.classList.add("hovered")},onMouseLeave:s=>{const r=s.target;r.classList.contains("hovered")&&r.classList.remove("hovered")}},i("span",{class:"item ellipsis"},(e==null?void 0:e.icon)&&i("z-icon",{class:"item-icon",name:e.icon}),i("span",{class:"item-label",title:e.label,innerHTML:this.renderItemLabel(e.label)})),(e==null?void 0:e.tag)&&i("z-tag",{icon:e.tag.icon},this.isMobile?"":e.tag.text)),e.children&&e.children.length>0?i("z-list",null,i("div",{class:"children-node"},e.children.map((s,r)=>this.renderItem(s,r,!1)))):null)}renderItemLabel(e){return this.searchString?e.replace(new RegExp(this.searchString.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gmi"),t=>`<mark>${t}</mark>`):e}renderItemCategory(e){return e!=null&&e.category?i("span",{class:"category-heading",slot:"header-title"},i("span",{class:"category"},e.category),(e==null?void 0:e.subcategory)&&i("span",{class:"subcategory"},e.subcategory)):null}renderSearchHelper(e=!0){return!this.autocomplete||this.preventSubmit||!this.searchString?null:i("z-list-element",{role:"option",dividerType:e?u.ELEMENT:void 0,id:`list-item-${this.htmlid}-search`,onKeyDown:t=>this.handleArrowsNavigation(t)},i("div",{tabindex:0,onClick:()=>this.emitSearchSubmit(),onKeyDown:t=>d(t,()=>this.emitSearchSubmit()),class:"list-element"},i("span",{class:"item item-search"},i("z-icon",{class:"search-icon",name:"left-magnifying-glass"}),i("span",{class:"item-label",innerHTML:this.searchHelperLabel.replace("{searchString}",`<mark>${this.searchString}</mark>`)}))))}renderShowAllResults(){var e,t;return!this.currResultsCount||!this.searchString||!(!((e=this.resultsItemsList)===null||e===void 0)&&e.length)||this.currResultsCount>=((t=this.resultsItemsList)===null||t===void 0?void 0:t.length)?null:i("z-list-element",{role:"option",tabindex:0,clickable:!0,id:`list-item-${this.htmlid}-show-all`,onClickItem:()=>this.currResultsCount=0,color:"color-primary01"},i("div",{class:"item-show-all"},"Vedi tutti i risultati"))}render(){return i(k,{key:"3046f87de5beb4e287f737ca826733520d7b46c2",onFocus:()=>this.showResults=!0,onClick:e=>this.handleOutsideClick(e),class:{"has-submit":this.showSearchButton,"has-results":this.autocomplete}},i("div",{key:"5f2e5e6c3b9cace2defe4ebcfe6d72362a5ac07f",class:"input-container"},this.renderInput(),this.renderResults()),this.renderButton())}get element(){return this}static get watchers(){return{resultsItems:["watchItems"],resultsCount:["watchResultsCount"],value:["watchValue"],searchString:["watchSearchString"],showResults:["watchShowResults"]}}static get style(){return L}};S(E,[1,"z-searchbar",{htmlid:[513],preventSubmit:[4,"prevent-submit"],value:[1],placeholder:[1],autocomplete:[4],autocompleteMinChars:[2,"autocomplete-min-chars"],resultsCount:[2,"results-count"],searchHelperLabel:[1,"search-helper-label"],resultsItems:[1,"results-items"],sortResultsItems:[4,"sort-results-items"],showSearchButton:[4,"show-search-button"],searchButtonIconOnly:[4,"search-button-icon-only"],size:[8],variant:[8],searchString:[32],currResultsCount:[32],showResults:[32],isMobile:[32],selectedItem:[32]},[[4,"click","handleOutsideClick"]],{resultsItems:["watchItems"],resultsCount:["watchResultsCount"],value:["watchValue"],searchString:["watchSearchString"],showResults:["watchShowResults"]}]);const v={schemaVersion:"1.0.0",modules:[{kind:"javascript-module",path:"",declarations:[{kind:"class",name:"ZSearchbar",tagName:"z-searchbar",customElement:!0,members:[{kind:"field",name:"htmlid",type:"string",description:"the id of the searchbar element",default:"`searchbar-${randomId()}`"},{kind:"field",name:"preventSubmit",type:"boolean",description:"Prevent submit action",default:"false"},{kind:"field",name:"value",type:"string",description:"Input search string"},{kind:"field",name:"placeholder",type:"string",description:"Search input placeholder"},{kind:"field",name:"autocomplete",type:"boolean",description:"Show autocomplete results",default:"false"},{kind:"field",name:"autocompleteMinChars",type:"number",description:"Minimun number of characters to dispatch typing event",default:"3"},{kind:"field",name:"resultsCount",type:"number",description:"Number of results shown - default all"},{kind:"field",name:"searchHelperLabel",type:"string",description:"Search helper text",default:'"Cerca {searchString}"'},{kind:"field",name:"resultsItems",type:"string",description:"Autocomplete results items"},{kind:"field",name:"sortResultsItems",type:"boolean",description:"Sort autocomplete results items",default:"false"},{kind:"field",name:"showSearchButton",type:"boolean",description:"Show submit button",default:"false"},{kind:"field",name:"searchButtonIconOnly",type:"boolean",description:"Set button icon without label",default:"false"},{kind:"field",name:"size",type:"any",description:"Available sizes: `big`, `small` and `x-small`. Defaults to `big`.",default:"ControlSize.BIG"},{kind:"field",name:"variant",type:"any",description:"Graphical variant: `primary`, `secondary`, `tertiary`. Defaults to `primary`.",default:"ButtonVariant.PRIMARY"}],events:[{kind:"event",name:"searchSubmit",description:"Emitted on search submit, return search string"},{kind:"event",name:"searchTyping",description:"Emitted on search typing, return search string"},{kind:"event",name:"searchItemClick",description:"Emitted on search result click, return item"}],cssProperties:[{name:"--z-searchbar-results-height",description:"Max height of the results container (default: 540px)"},{name:"--z-searchbar-tag-text-color",description:"Color of tag's text (default --color-primary03);"},{name:"--z-searchbar-tag-bg",description:"Color of tag's background (default --color-hover-primary);"}]}],exports:[{kind:"js",name:"ZSearchbar",declaration:{name:"ZSearchbar",module:"src/components/z-searchbar/index.tsx"}},{kind:"custom-element-definition",name:"z-searchbar",declaration:{name:"ZSearchbar",module:"src/components/z-searchbar/index.tsx"}}]}]};w({...p()||{},...v,modules:[...(p()||{}).modules||[],...v.modules]});
