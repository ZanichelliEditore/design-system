import{r as registerInstance,c as createEvent,h,g as getElement}from"./index-ab5f1eaa.js";import{I as InputType,e as ControlSize,i as ListSize,g as KeyboardCode,l as ListDividerType}from"./index-2255c6c8.js";import{r as randomId,a as handleKeyboardSubmit}from"./utils-7983d02c.js";import"./breakpoints-680e0e56.js";var stylesCss=':host{display:block;font-family:var(--font-family-sans)}:host>div.fixed{position:relative}:host>div>.header{position:relative;z-index:10;display:-ms-flexbox;display:flex;min-height:42px;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;padding:0 calc(var(--space-unit) * 1.5);border:var(--border-size-small) solid var(--color-surface04);margin:0;background-color:var(--color-input-field01);border-radius:var(--border-radius-small);cursor:pointer}:host([size="small"])>div>.header{min-height:34px;font-size:var(--font-size-2)}:host([size="x-small"])>div>.header{min-height:30px;font-size:var(--font-size-2)}:host([size="x-small"])>div>.header p.body-3{padding:calc(var(--space-unit) * 0.5) 0}:host>div>.header:hover{outline:var(--border-size-medium) solid var(--color-surface04);outline-offset:-2px}:host>div.open>div.header:focus:focus-visible{-webkit-box-shadow:none;box-shadow:none}:host>div>div.header:focus:focus-visible{-webkit-box-shadow:var(--shadow-focus-primary);box-shadow:var(--shadow-focus-primary);outline:none}:host>div>.header>p.body-3{padding:var(--space-unit) 0;margin:0;color:var(--color-default-text)}:host>div>.header>p.body-3>span{font-weight:var(--font-sb)}:host>div>.header>z-icon{fill:var(--color-default-icon);-webkit-transform:rotate(360deg);transform:rotate(360deg);-webkit-transition:all 200ms linear;transition:all 200ms linear}:host>div>.header>z-icon.small,:host>div>.header>z-icon.x-small{--z-icon-width:16px;--z-icon-height:16px}:host>div.open>.header{border:var(--border-size-small) solid var(--color-primary01);border-radius:var(--border-radius-small) var(--border-radius-small) 0 0}:host>div.disabled{pointer-events:none}:host>div.disabled .header{border-color:var(--color-disabled01);fill:var(--color-disabled01)}:host>div.disabled .header>p.body-3{color:var(--color-disabled03)}:host>div.disabled .header>z-icon:last-child{fill:var(--color-disabled01)}:host>div.open>.header>z-icon{fill:var(--color-default-icon);-webkit-transform:rotate(180deg);transform:rotate(180deg);-webkit-transition:all 200ms linear;transition:all 200ms linear}:host>div.open>div.open-combo-data{position:relative;z-index:12;padding:var(--space-unit) calc(var(--space-unit) * 2);border:var(--border-size-small) solid var(--gray200);border-top:0;background-color:var(--color-input-field01);border-radius:0}:host>div.open>div.open-combo-data>div>div{overflow:auto;max-height:235px;padding:0;scrollbar-color:var(--color-primary01) transparent}:host>div.open>div.open-combo-data>z-input{width:100%;margin-bottom:calc(var(--space-unit) * 2)}:host>div.open>div.open-combo-data>div>div>ul{max-height:235px;padding:0 3px;margin:0}::-webkit-scrollbar{width:10px;background:linear-gradient(to right, transparent 0 3px, var(--gray200) 3px 7px, transparent 7px 10px);border-radius:var(--border-radius)}::-webkit-scrollbar-thumb{width:10px;background-color:var(--color-primary01)}:host>div.open>z-input{position:relative;z-index:1;width:238px;margin:0 calc(var(--space-unit) * 2);color:var(--color-primary01)}:host>div.open>div.open-combo-data>div>div.search{overflow:hidden;max-height:auto;margin-top:0;-webkit-box-shadow:1px 1px 4px 2px rgb(217 222 227 / 50%);box-shadow:1px 1px 4px 2px rgb(217 222 227 / 50%)}:host>div.open>div.open-combo-data>div>div.search>ul{overflow:auto;max-height:180px;padding:var(--space-unit) calc(var(--space-unit) * 2);scrollbar-color:var(--color-primary01) transparent}:host>div.open>div.open-combo-data>div>div.search>div{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}:host>div.open>div.open-combo-data>div>div.search>div>a{display:inline-block;height:44px;color:var(--color-primary01);cursor:pointer;font-size:14px;font-weight:var(--font-sb);line-height:44px;text-align:center;text-transform:uppercase}:host>div.open>div.open-combo-data>div>div.check-all-wrapper{padding:calc(var(--space-unit) * 2) calc(var(--space-unit) * 0.5);border-bottom:var(--border-size-small) solid var(--gray800);margin-bottom:var(--space-unit);text-align:left}:host([size="small"])>div.open>div.open-combo-data>div>div.check-all-wrapper{padding:calc(var(--space-unit) * 1.5) calc(var(--space-unit) * 0.5)}:host([size="x-small"])>div.open>div.open-combo-data>div>div.check-all-wrapper{padding:var(--space-unit) calc(var(--space-unit) * 0.5)}';var ZComboboxStyle0=stylesCss;var ZCombobox=function(){function i(i){registerInstance(this,i);this.comboboxChange=createEvent(this,"comboboxChange",7);this.itemsList=[];this.inputType=InputType.TEXT;this.inputid="combo-".concat(randomId());this.items=undefined;this.label=undefined;this.disabled=false;this.hassearch=false;this.searchlabel=undefined;this.searchplaceholder=undefined;this.searchtitle=undefined;this.noresultslabel="Nessun risultato";this.isopen=false;this.isfixed=false;this.closesearchtext="Chiudi";this.hascheckall=false;this.checkalltext="Seleziona tutti";this.uncheckalltext="Deseleziona tutti";this.maxcheckableitems=0;this.hasgroupitems=undefined;this.size=ControlSize.BIG;this.searchValue=undefined;this.selectedCounter=undefined;this.renderItemsList=[];this.focusedItemId=undefined;this.checkboxes=[];this.toggleComboBox=this.toggleComboBox.bind(this);this.closeFilterItems=this.closeFilterItems.bind(this)}i.prototype.watchItems=function(){this.itemsList=typeof this.items==="string"?JSON.parse(this.items):this.items;this.selectedCounter=this.itemsList.filter((function(i){return i.checked})).length;this.updateRenderItemsList()};i.prototype.watchSearchValue=function(){this.filterItems(this.searchValue)};i.prototype.watchCheckboxes=function(){this.checkboxes.forEach((function(i,t){return i.setAttribute("tabindex",t===0?"0":"-1")}))};i.prototype.emitComboboxChange=function(){this.comboboxChange.emit({id:this.inputid,items:this.itemsList})};i.prototype.componentWillLoad=function(){this.watchItems()};i.prototype.componentWillRender=function(){this.selectedCounter=this.itemsList.filter((function(i){return i.checked})).length};i.prototype.componentDidRender=function(){var i=this.getAllCheckboxes();if(JSON.stringify(i)!==JSON.stringify(this.checkboxes)){this.checkboxes=i}};i.prototype.getItemId=function(i){return"combo-checkbox-".concat(this.inputid,"-").concat(i.id)};i.prototype.getCheckboxClass=function(){return"combo-item-checkbox-input-".concat(this.inputid)};i.prototype.getAllCheckboxes=function(){return Array.from(this.element.shadowRoot.querySelectorAll(".".concat(this.getCheckboxClass()," input:not([disabled])")))};i.prototype.getControlToListSize=function(){switch(this.size){case ControlSize.X_SMALL:return ListSize.SMALL;case ControlSize.SMALL:return ListSize.MEDIUM;default:return ListSize.LARGE}};i.prototype.handleSelectArrowsNavigation=function(i,t){if(![KeyboardCode.ARROW_DOWN,KeyboardCode.ARROW_UP].includes(i.key)||!this.isopen){return}i.preventDefault();i.stopPropagation();var e=this.element.shadowRoot.querySelector("#".concat(t));if(!e){return}var o=this.checkboxes;if(!o.length){return}var r=o.indexOf(e);var n=0;var s=o.length-1;var a=null;if(i.key===KeyboardCode.ARROW_DOWN){a=r===s?o[n]:o[r+1]}else if(i.key===KeyboardCode.ARROW_UP){a=r===n?o[s]:o[r-1]}this.focusComboboxItem(a)};i.prototype.handleHeaderKeyboardEvent=function(i){if(i.key===KeyboardCode.SPACE){i.preventDefault()}if(i.key===KeyboardCode.ARROW_DOWN&&!this.isopen||i.key===KeyboardCode.ARROW_UP&&this.isopen){this.toggleComboBox()}};i.prototype.handleCheckboxFocus=function(i){this.focusedItemId=i};i.prototype.focusComboboxItem=function(i){this.checkboxes.forEach((function(i){i.setAttribute("tabindex","-1")}));i.setAttribute("tabindex","0");i.focus()};i.prototype.updateRenderItemsList=function(){if(this.searchValue){this.filterItems(this.searchValue)}else{this.resetRenderItemsList()}};i.prototype.resetRenderItemsList=function(){var i=[];this.itemsList.forEach((function(t){i.push(Object.assign({},t))}));this.renderItemsList=i};i.prototype.filterItems=function(i){if(!i){return this.closeFilterItems()}this.resetRenderItemsList();this.renderItemsList=this.renderItemsList.filter((function(t){var e=t.name.toUpperCase().indexOf(i.toUpperCase());var o=e+i.length;var r=t.name.substring(0,e)+"<strong>"+t.name.substring(e,o)+"</strong>"+t.name.substring(o,t.name.length);t.name=r;return e>=0}))};i.prototype.checkAll=function(i){if(i===void 0){i=true}this.itemsList=this.itemsList.map((function(t){return Object.assign(Object.assign({},t),{checked:i})}));this.resetRenderItemsList();this.emitComboboxChange()};i.prototype.closeFilterItems=function(){this.searchValue="";this.resetRenderItemsList()};i.prototype.toggleComboBox=function(){this.isopen=!this.isopen};i.prototype.getComboboxA11yAttributes=function(){return{role:"combobox","aria-label":this.label,"aria-expanded":this.isopen?"true":"false","aria-activedescendant":this.isopen?this.focusedItemId:"","aria-controls":"".concat(this.inputid,"_list")}};i.prototype.renderHeader=function(){var i=this;return h("div",{class:"header",onClick:function(){return i.toggleComboBox()},onKeyDown:function(t){i.handleHeaderKeyboardEvent(t)},onKeyUp:function(t){return handleKeyboardSubmit(t,i.toggleComboBox)},role:"button",tabindex:0,"aria-expanded":this.isopen?"true":"false"},h("p",{class:"body-3"},this.label,h("span",null,this.selectedCounter>0&&" (".concat(this.selectedCounter,")"))),h("z-icon",{name:"caret-down",class:this.size}))};i.prototype.renderContent=function(){if(!this.isopen){return}return h("div",{class:"open-combo-data"},this.hassearch&&this.renderSearchInput(),!this.hassearch?h("span",Object.assign({},this.getComboboxA11yAttributes())):null,h("div",{role:"listbox","aria-label":this.label,"aria-multiselectable":true,id:"".concat(this.inputid,"_list"),"aria-owns":"".concat(this.checkboxes.map((function(i){return i.id})).join(" "))},this.hascheckall&&this.renderCheckAll(),this.renderItems()))};i.prototype.renderItems=function(){return h("div",{class:this.searchValue&&"search"},this.renderList(this.renderItemsList),this.searchValue&&this.renderCloseButton())};i.prototype.renderItem=function(i,t,e){var o=this;return h("z-list-element",{id:i.id,htmlTabindex:null,dividerType:t!==e-1?ListDividerType.ELEMENT:ListDividerType.NONE,size:this.getControlToListSize()},h("z-input",{type:InputType.CHECKBOX,checked:i.checked,htmlid:this.getItemId(i),label:i.name,class:this.getCheckboxClass(),disabled:!i.checked&&this.maxcheckableitems&&this.selectedCounter>=this.maxcheckableitems,size:this.size===ControlSize.X_SMALL?ControlSize.SMALL:this.size,role:"option","aria-selected":i.checked?"true":"false",onKeyDown:function(t){return o.handleSelectArrowsNavigation(t,o.getItemId(i))},onInputCheck:function(t){o.itemsList=o.itemsList.map((function(e){if(i.id===e.id){e.checked=t.detail.checked}return e}));o.updateRenderItemsList();o.emitComboboxChange()},onInputFocus:function(i){return o.handleCheckboxFocus(i.detail.id)}}))};i.prototype.renderList=function(i){var t=this;if(!i){return}if(!i.length&&this.searchValue){return this.renderNoSearchResults()}if(this.hasgroupitems){return this.renderGroups(i)}return h("ul",{role:"none"},i.map((function(e,o){return t.renderItem(e,o,i.length)})))};i.prototype.renderGroups=function(i){var t=this;var e=i.reduce((function(e,o,r){var n;var s=o.category;var a=t.renderItem(o,r,i.length);e[s]=(n=e[s])!==null&&n!==void 0?n:[];e[s].push(a);return e}),{});var o=Object.entries(e).map((function(i){var t=i[0],e=i[1];return h("z-list-group",{"divider-type":ListDividerType.ELEMENT},h("span",{class:"body-3-sb z-list-group-title",slot:"header-title"},t),e.map((function(i){return i})))}));return h("ul",{role:"none"},o)};i.prototype.renderNoSearchResults=function(){return h("ul",{role:"none"},h("z-myz-list-item",{id:"no-results",text:this.noresultslabel,listitemid:"no-results",icon:"multiply-circle",class:this.size}))};i.prototype.renderCloseButton=function(){var i=this;return h("div",null,h("a",{onClick:function(){return i.closeFilterItems()},onKeyUp:function(t){return handleKeyboardSubmit(t,i.closeFilterItems)},role:"button",tabindex:0},this.closesearchtext))};i.prototype.renderSearchInput=function(){var i=this;return h("z-input",Object.assign({htmlid:"".concat(this.inputid,"_search"),label:this.searchlabel,placeholder:this.searchplaceholder,htmltitle:this.searchtitle,type:this.inputType,value:this.searchValue,message:false,size:this.size,"aria-autocomplete":"list"},this.getComboboxA11yAttributes(),{onKeyUp:function(t){if(t.key===KeyboardCode.ESC){i.closeFilterItems()}},onInputChange:function(t){i.searchValue=t.detail.value}}))};i.prototype.renderCheckAll=function(){var i=this;if(this.searchValue){return}var t="combo-checkbox-".concat(this.inputid,"-check-all");var e=this.selectedCounter===this.itemsList.length;return h("div",{class:"check-all-wrapper"},h("z-input",{type:InputType.CHECKBOX,checked:e,htmlid:t,class:this.getCheckboxClass(),label:e?this.uncheckalltext:this.checkalltext,disabled:this.maxcheckableitems&&this.maxcheckableitems<this.itemsList.length,size:this.size===ControlSize.X_SMALL?ControlSize.SMALL:this.size,role:"option","aria-selected":e?"true":"false",onKeyDown:function(e){return i.handleSelectArrowsNavigation(e,t)},onInputCheck:function(t){return i.checkAll(t.detail.checked)},onInputFocus:function(t){return i.handleCheckboxFocus(t.detail.id)}}))};i.prototype.render=function(){return h("div",{key:"118ffd4229b6b7f060d9b28ace7d5a59796620b9","data-action":"combo-".concat(this.inputid),class:{open:this.isopen,fixed:this.isfixed,disabled:this.disabled},id:this.inputid},this.renderHeader(),!this.disabled&&this.renderContent())};Object.defineProperty(i.prototype,"element",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(i,"watchers",{get:function(){return{items:["watchItems"],searchValue:["watchSearchValue"],checkboxes:["watchCheckboxes"]}},enumerable:false,configurable:true});return i}();ZCombobox.style=ZComboboxStyle0;export{ZCombobox as z_combobox};
//# sourceMappingURL=z-combobox.entry.js.map