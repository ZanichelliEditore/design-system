var __awaiter=this&&this.__awaiter||function(e,t,s,i){function r(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,n){function c(e){try{a(i.next(e))}catch(e){n(e)}}function l(e){try{a(i["throw"](e))}catch(e){n(e)}}function a(e){e.done?s(e.value):r(e.value).then(c,l)}a((i=i.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var s={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,r,n,c;return c={next:l(0),throw:l(1),return:l(2)},typeof Symbol==="function"&&(c[Symbol.iterator]=function(){return this}),c;function l(e){return function(t){return a([e,t])}}function a(l){if(i)throw new TypeError("Generator is already executing.");while(c&&(c=0,l[0]&&(s=0)),s)try{if(i=1,r&&(n=l[0]&2?r["return"]:l[0]?r["throw"]||((n=r["return"])&&n.call(r),0):r.next)&&!(n=n.call(r,l[1])).done)return n;if(r=0,n)l=[l[0]&2,n.value];switch(l[0]){case 0:case 1:n=l;break;case 4:s.label++;return{value:l[1],done:false};case 5:s.label++;r=l[1];l=[0];continue;case 7:l=s.ops.pop();s.trys.pop();continue;default:if(!(n=s.trys,n=n.length>0&&n[n.length-1])&&(l[0]===6||l[0]===2)){s=0;continue}if(l[0]===3&&(!n||l[1]>n[0]&&l[1]<n[3])){s.label=l[1];break}if(l[0]===6&&s.label<n[1]){s.label=n[1];n=l;break}if(n&&s.label<n[2]){s.label=n[2];s.ops.push(l);break}if(n[2])s.ops.pop();s.trys.pop();continue}l=t.call(e,s)}catch(e){l=[6,e];r=0}finally{i=n=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:true}}};import{r as registerInstance,c as createEvent,h,g as getElement}from"./index-ab5f1eaa.js";import{e as ControlSize,g as KeyboardCode,l as ListDividerType,i as ListSize}from"./index-a7f69d42.js";import{r as randomId,b as boolean,d as getElementTree,a as handleKeyboardSubmit,e as getClickedElement}from"./utils-0ce33738.js";import"./breakpoints-680e0e56.js";var stylesCss='.sc-z-select-h{display:inline-block;width:inherit;color:var(--color-default-text);font-family:var(--font-family-sans);font-size:var(--font-size-3);font-weight:var(--font-rg)}[size="small"].sc-z-select-h,[size="x-small"].sc-z-select-h{font-size:var(--font-size-2)}.select-wrapper.sc-z-select>z-input.sc-z-select{width:100%}.select-wrapper.sc-z-select>div.sc-z-select{position:relative}.select-wrapper.sc-z-select>div.closed.sc-z-select{overflow:hidden;height:0}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select{position:absolute;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:calc(var(--space-unit) * 0.5) var(--space-unit);border:var(--border-size-small) solid var(--gray200);border-top:none;background:var(--color-surface01);outline:none}.select-wrapper.sc-z-select .closed.sc-z-select .ul-scroll-wrapper.sc-z-select{z-index:10}.select-wrapper.sc-z-select .open.sc-z-select .ul-scroll-wrapper.sc-z-select{z-index:20}.select-wrapper.sc-z-select .ul-scroll-wrapper.fixed.sc-z-select{position:static}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select{position:relative;overflow:auto;max-height:240px;padding:calc(var(--space-unit) * 0.5);outline:none;scrollbar-color:var(--color-primary01) transparent}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar{width:10px;background:linear-gradient(to right, transparent 0 3px, var(--gray200) 3px 7px, transparent 7px 10px);border-radius:var(--border-radius)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar-track{background-color:transparent}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar-thumb{width:10px;background-color:var(--color-primary01);border-radius:var(--border-radius)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select>z-list.sc-z-select::-webkit-scrollbar-thumb:hover{background-color:var(--color-hover-primary)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;padding-left:calc(var(--space-unit) * 1.5)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select .list-element-content.sc-z-select{display:block;padding:calc(var(--space-unit) * 0.5) 0}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select>z-icon.sc-z-select+.list-element-content.sc-z-select{display:block;padding:calc(var(--space-unit) * 0.5) var(--space-unit)}[size="x-small"].sc-z-select-h .select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select .list-element-content.sc-z-select{padding:0}[size="small"].sc-z-select-h .select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select>z-icon.sc-z-select{--z-icon-width:16px;--z-icon-height:16px}[size="x-small"].sc-z-select-h .select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select>z-icon.sc-z-select{--z-icon-width:14px;--z-icon-height:14px}[size="x-small"].sc-z-select-h .select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select>z-icon.sc-z-select+.list-element-content.sc-z-select{padding:0 var(--space-unit)}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select z-list.sc-z-select z-list-element.sc-z-select .list-element-container.sc-z-select .list-element-content.selected.sc-z-select{font-weight:bold}.select-wrapper.sc-z-select .ul-scroll-wrapper.sc-z-select .no-results.sc-z-select z-icon.sc-z-select{margin-right:var(--space-unit)}.z-list-group-title.sc-z-select{color:var(--gray800)}.reset-item.sc-z-select{color:var(--color-primary01);fill:var(--color-primary01)}.reset-item-content.sc-z-select{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.reset-item.reset-item-margin.sc-z-select .reset-item-content.sc-z-select{margin-left:calc(var(--space-unit))}.reset-item.sc-z-select .reset-item-content.sc-z-select>z-icon.sc-z-select{margin-right:var(--space-unit)}.reset-item.hide.sc-z-select{display:none}';var ZSelectStyle0=stylesCss;var ZSelect=function(){function e(e){registerInstance(this,e);this.optionSelect=createEvent(this,"optionSelect",7);this.resetSelect=createEvent(this,"resetSelect",7);this.itemsList=[];this.htmlid="id-".concat(randomId());this.items=undefined;this.name=undefined;this.label=undefined;this.ariaLabel="";this.disabled=false;this.readonly=false;this.placeholder=undefined;this.htmltitle=undefined;this.status=undefined;this.message=true;this.autocomplete=false;this.noresultslabel="Nessun risultato";this.hasGroupItems=undefined;this.isfixed=false;this.resetItem=undefined;this.size=ControlSize.BIG;this.isOpen=false;this.selectedItem=null;this.focusedItemId=undefined;this.searchString=undefined;this.toggleSelectUl=this.toggleSelectUl.bind(this);this.selectItem=this.selectItem.bind(this);this.handleSelectFocus=this.handleSelectFocus.bind(this)}e.prototype.watchItems=function(){this.itemsList=this.getInitialItemsArray();this.selectedItem=this.itemsList.find((function(e){return e.selected}))};e.prototype.getFocusedItemHandler=function(e){this.focusedItemId=e.target.id};e.prototype.getSelectedItem=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,this.selectedItem]}))}))};e.prototype.getValue=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,this.getSelectedValue()]}))}))};e.prototype.setValue=function(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(s){t=[];if(typeof e==="string"){t.push(e)}else{t=e}this.selectedItem=this.itemsList.find((function(e){return t.includes(e.id)}));return[2]}))}))};e.prototype.emitOptionSelect=function(){this.optionSelect.emit({id:this.htmlid,selected:this.getSelectedValue()})};e.prototype.emitResetSelect=function(){this.resetSelect.emit({id:this.htmlid})};e.prototype.componentWillLoad=function(){this.watchItems()};e.prototype.componentWillRender=function(){this.filterItems(this.searchString)};e.prototype.getInitialItemsArray=function(){return typeof this.items==="string"?JSON.parse(this.items):this.items};e.prototype.mapSelectedItemToItemsArray=function(){var e=this;var t=this.getInitialItemsArray();return t.map((function(t){var s;t.selected=t.id===((s=e.selectedItem)===null||s===void 0?void 0:s.id);return t}))};e.prototype.getSelectedValue=function(){var e;return(e=this.selectedItem)===null||e===void 0?void 0:e.id};e.prototype.filterItems=function(e){var t=this.mapSelectedItemToItemsArray();if(!(e===null||e===void 0?void 0:e.length)){this.itemsList=t}else{this.itemsList=t.filter((function(t){return t.name.toUpperCase().includes(e.toUpperCase())})).map((function(t){var s=t.name.toUpperCase().indexOf(e.toUpperCase());var i=s+e.length;var r=t.name.substring(0,s)+"<strong>".concat(t.name.substring(s,i),"</strong>")+t.name.substring(i,t.name.length);t.name=r;return t}))}};e.prototype.hasAutocomplete=function(){return boolean(this.autocomplete)===true};e.prototype.handleInputChange=function(e){this.searchString=e.detail.value;if(!this.isOpen){this.toggleSelectUl()}};e.prototype.selectItem=function(e,t){if(e&&e.disabled){return}this.itemsList=this.mapSelectedItemToItemsArray();this.itemsList=this.itemsList.map((function(s){s.selected=false;if(s.id===(e===null||e===void 0?void 0:e.id)){s.selected=t}return s}));this.selectedItem=this.itemsList.find((function(e){return e.selected}));this.emitOptionSelect();if(this.searchString){this.searchString=null}};e.prototype.arrowsSelectNav=function(e,t){var s=this.resetItem&&!!this.selectedItem;var i=[KeyboardCode.ARROW_DOWN,KeyboardCode.ARROW_UP];if(!i.includes(e.key)){return}e.preventDefault();e.stopPropagation();if(!this.isOpen){this.toggleSelectUl()}var r;if(this.resetItem){if(e.key===KeyboardCode.ARROW_DOWN){r=t+1===this.itemsList.length+1?+!s:t+1}else if(e.key===KeyboardCode.ARROW_UP){r=t<=+!s?this.itemsList.length:t-1}}if(!this.resetItem){if(e.key===KeyboardCode.ARROW_DOWN){r=t+1===this.itemsList.length?0:t+1}else if(e.key===KeyboardCode.ARROW_UP){r=t<=0?this.itemsList.length-1:t-1}}this.focusSelectItem(r)};e.prototype.focusSelectItem=function(e){var t=this.element.querySelector("#".concat(this.htmlid,"_").concat(e));if(t){t.focus()}};e.prototype.toggleSelectUl=function(e){if(e===void 0){e=false}if(this.disabled||this.readonly){return}if(!this.isOpen){document.addEventListener("click",this.handleSelectFocus);document.addEventListener("keyup",this.handleSelectFocus)}else{document.removeEventListener("click",this.handleSelectFocus);document.removeEventListener("keyup",this.handleSelectFocus);if(e){this.element.querySelector("#".concat(this.htmlid,"_input")).focus()}}this.focusedItemId="";this.isOpen=!this.isOpen};e.prototype.handleInputClick=function(e){var t=e.composedPath();var s=t.find((function(e){return e.classList&&e.classList.contains("reset-icon")}));if(s){e.stopPropagation();return}this.toggleSelectUl()};e.prototype.handleSelectFocus=function(e){var t=this;if(e instanceof KeyboardEvent&&e.key===KeyboardCode.ESC){e.stopPropagation();return this.toggleSelectUl(true)}if(e instanceof KeyboardEvent&&e.key!==KeyboardCode.TAB&&e.key!==KeyboardCode.ENTER){return}var s=getElementTree(getClickedElement());var i=s.find((function(e){return e.nodeName.toLowerCase()==="z-input"&&e.id==="".concat(t.htmlid,"_input")}));if(!i){this.toggleSelectUl(e instanceof MouseEvent?true:false)}};e.prototype.scrollToLetter=function(e){var t=this.itemsList.find((function(t){return t.name.charAt(0)===e}));if(t){this.focusSelectItem(this.itemsList.indexOf(t))}};e.prototype.renderInput=function(){var e=this;return h("z-input",{class:{"active-select":this.isOpen,"cursor-select":!this.autocomplete},id:"".concat(this.htmlid,"_input"),htmlid:"".concat(this.htmlid,"_select_input"),placeholder:this.placeholder,value:!this.isOpen&&this.selectedItem?this.selectedItem.name.replace(/<[^>]+>/g,""):null,label:this.label,"aria-expanded":this.isOpen?"true":"false","aria-label":this.ariaLabel,"aria-controls":"".concat(this.htmlid,"_list"),"aria-autocomplete":this.hasAutocomplete()?"list":"none","aria-activedescendant":this.isOpen?this.focusedItemId:"",icon:this.isOpen?"caret-up":"caret-down",hasclearicon:this.hasAutocomplete(),message:false,disabled:this.disabled,readonly:this.readonly||!this.hasAutocomplete()&&this.isOpen,status:this.isOpen?undefined:this.status,role:"combobox",size:this.size,onClick:function(t){e.handleInputClick(t)},onKeyUp:function(t){if(t.keyCode!==13){t.preventDefault()}handleKeyboardSubmit(t,e.toggleSelectUl)},onKeyDown:function(t){return e.arrowsSelectNav(t,e.selectedItem?e.itemsList.indexOf(e.selectedItem):e.resetItem?0:-1)},onInputChange:function(t){e.handleInputChange(t)},onKeyPress:function(t){if(!e.hasAutocomplete()){t.preventDefault();e.scrollToLetter(String.fromCharCode(t.keyCode))}}})};e.prototype.renderSelectUl=function(){var e;return h("div",{class:this.isOpen?"open":"closed",tabindex:"-1"},h("div",{class:{"ul-scroll-wrapper":true,fixed:this.isfixed},tabindex:"-1"},h("z-list",{role:"listbox","aria-label":this.ariaLabel||this.label,tabindex:this.disabled||this.readonly||!this.isOpen?-1:0,id:"".concat(this.htmlid,"_list"),"aria-multiselectable":false,size:this.listSizeType(),class:(e={disabled:this.disabled,readonly:this.readonly,filled:!!this.selectedItem},e["input-".concat(this.status)]=!this.isOpen&&!!this.status,e)},this.resetItem&&this.renderResetItem(),this.renderSelectUlItems())))};e.prototype.renderResetItem=function(){var e=this;return h("z-list-element",{class:{hide:!this.selectedItem||!this.resetItem,"reset-item":true,"reset-item-margin":!this.hasGroupItems},clickable:true,disabled:false,dividerType:ListDividerType.ELEMENT,role:"option",tabindex:"0","aria-selected":"false",id:"".concat(this.htmlid,"_").concat(this.resetItem?"0":"none"),size:this.listSizeType(),onClickItem:function(){e.selectedItem=null;e.searchString=null;e.emitResetSelect()},onKeyDown:function(t){return e.arrowsSelectNav(t,0)}},h("div",{class:"reset-item-content"},h("z-icon",{name:"multiply-circled"}),h("span",null,this.resetItem)))};e.prototype.renderItem=function(e,t,s){var i=this;return h("z-list-element",{clickable:!e.disabled,disabled:e.disabled,dividerType:s?ListDividerType.HEADER:ListDividerType.ELEMENT,role:"option",tabindex:e.disabled||!this.isOpen?-1:0,"aria-selected":e.selected?"true":"false",id:"".concat(this.htmlid,"_").concat(t),size:this.listSizeType(),onClickItem:function(){return i.selectItem(e,true)},onKeyDown:function(e){return i.arrowsSelectNav(e,t)}},h("div",{class:"list-element-container"},e.icon&&h("z-icon",{name:e.icon}),h("span",{class:{selected:!!e.selected,"list-element-content":true},innerHTML:e.name})))};e.prototype.listSizeType=function(){if(this.size===ControlSize.SMALL||this.size===ControlSize.X_SMALL){return ListSize.SMALL}return ListSize.MEDIUM};e.prototype.renderSelectUlItems=function(){var e=this;if(!this.itemsList.length){return this.renderNoSearchResults()}if(this.hasGroupItems){return this.renderSelectGroupItems()}return this.itemsList.map((function(t,s,i){var r=i.length===s+1;var n=e.resetItem?s+1:s;return e.renderItem(t,n,r)}))};e.prototype.renderSelectGroupItems=function(){var e=this;var t=this.itemsList.reduce((function(t,s,i,r){var n;var c=s.category;var l=r.length===i+1;var a=e.resetItem?i+1:i;var o=e.renderItem(s,a,l);t[c]=(n=t[c])!==null&&n!==void 0?n:[];t[c].push(o);return t}),{});return Object.entries(t).map((function(e){var t=e[0],s=e[1];return h("z-list-group",{"divider-type":ListDividerType.ELEMENT},h("span",{class:"body-3-sb z-list-group-title",slot:"header-title"},t),s.map((function(e){return e})))}))};e.prototype.renderNoSearchResults=function(){return h("z-list-element",{color:"blue500",class:"no-results",size:this.listSizeType()},h("z-icon",{name:"multiply-circle",fill:"blue500"}),this.noresultslabel)};e.prototype.renderMessage=function(){if(boolean(this.message)===false){return}return h("z-input-message",{message:boolean(this.message)===true?undefined:this.message,status:this.status,class:this.size})};e.prototype.render=function(){return h("div",{key:"9746ad38f69cb9f568cd1ef2e36937ae0f13bfed",class:"select-wrapper"},this.renderInput(),this.renderSelectUl(),this.renderMessage())};Object.defineProperty(e.prototype,"element",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{items:["watchItems"]}},enumerable:false,configurable:true});return e}();ZSelect.style=ZSelectStyle0;export{ZSelect as z_select};
//# sourceMappingURL=z-select.entry.js.map